import{a as v,f as i,c as ga,t as ya}from"../chunks/YPNk2NX5.js";import{b as Yt,s as L,w as ka,ab as Ft,g as t,n as x,ad as wa,j as e,k as a,m as T,d as Qt,ac as Q,f as nt,e as r}from"../chunks/ABNvuIHC.js";import{s as d,d as ja,a as et}from"../chunks/e87nZPu-.js";import{i as j}from"../chunks/CCxA75cu.js";import{s as R,c as M,e as vt,b as _t,d as Ct,i as St,a as At,r as ct,j as pt,k as Ta}from"../chunks/DeGR0Slq.js";import{s as dt,r as Ca}from"../chunks/ct8flr_T.js";import{a as Sa}from"../chunks/2sA3hMLD.js";import{b as it}from"../chunks/DF-P8710.js";import{a as Jt}from"../chunks/DtH33QRI.js";const Aa=!1,ke=Object.freeze(Object.defineProperty({__proto__:null,ssr:Aa},Symbol.toStringTag,{value:"Module"}));var Ua=i("<td> </td>");function Kt(mt,ot){Yt(ot,!0);let f=L(ka(Date.now())),E=null,st=Q(()=>ot.until?new Date(ot.until).getTime()-t(f):0),B=Q(()=>t(st)>0),W=Q(()=>{if(!t(B))return"–";const N=Math.floor(t(st)/6e4),rt=Math.floor(t(st)%6e4/1e3);return`${N}m ${String(rt).padStart(2,"0")}s`});Ft(()=>{t(B)&&!E?E=setInterval(()=>{x(f,Date.now(),!0)},1e3):!t(B)&&E&&(clearInterval(E),E=null)}),wa(()=>{E&&clearInterval(E)});var H=Ua(),V=e(H,!0);a(H),T(()=>{R(H,1,M(t(B)?"o":"muted")),d(V,t(W))}),v(mt,H),Qt()}var Oa=i('<p class="error-msg"> </p>'),qa=i('<p class="loading">loading dashboard...</p>'),Da=i('<p class="muted">no usage data yet</p>'),Ea=i("<b> </b>"),Na=i('<tr><td> </td><td class="num"> </td><td class="num"> </td><td class="num"> </td><td class="num"> </td><td class="num"><!></td></tr>'),Ia=i('<table><thead><tr><th></th><th class="num">requests</th><th class="num">input</th><th class="num">output</th><th class="num">cache read</th><th class="num">cost</th></tr></thead><tbody></tbody></table>'),Pa=i('<p class="muted">no claude accounts</p>'),Ra=i('<span class="muted">(a)</span>'),Ba=i('<span class="muted">&ndash;</span>'),Ha=i('<span> </span> <span class="muted"> </span>',1),La=i('<span class="muted">&ndash;</span>'),Ma=i('<span class="muted">&ndash;</span>'),za=i('<span> </span> <span class="muted"> </span>',1),Ga=i('<span class="muted">&ndash;</span>'),Ja=i('<tr><td><a> </a></td><td><span> </span></td><td> <!></td><!><td> </td><td class="num"><!></td><td class="num"><!></td></tr>'),Ka=i('<table><thead><tr><th>email</th><th>status</th><th>pri</th><th>cooldown</th><th>last used</th><th class="num">5h remain</th><th class="num">7d remain</th></tr></thead><tbody></tbody></table>'),Ya=i('<p class="muted">no codex accounts</p>'),Fa=i('<span class="muted">(a)</span>'),Qa=i('<span class="muted">&ndash;</span>'),Va=i('<span> </span> <span class="muted"> </span>',1),Wa=i('<span class="muted">&ndash;</span>'),Xa=i('<span class="muted">&ndash;</span>'),Za=i('<span> </span> <span class="muted"> </span>',1),$a=i('<span class="muted">&ndash;</span>'),te=i('<tr><td><a> </a></td><td><span> </span></td><td> <!></td><!><td> </td><td class="num"><!></td><td class="num"><!></td></tr>'),ae=i('<table><thead><tr><th>email</th><th>status</th><th>pri</th><th>cooldown</th><th>last used</th><th class="num">primary</th><th class="num">secondary</th></tr></thead><tbody></tbody></table>'),ee=i('<button class="link add-link">[+ add]</button>'),se=i('<span class="r" style="margin-left:8px;"> </span>'),re=i('<div class="bar"><input type="text" placeholder="username" style="width:160px;max-width:160px;margin-right:6px;"/> <button class="link">[create]</button> <button class="link">[cancel]</button> <!></div>'),ne=i('<div class="bar"><div><span class="g">&#10003; created</span> <b> </b> &mdash; token: <span style="user-select:all;"> </span> <button class="link">[dismiss]</button></div> <div class="r" style="font-size:11px;margin-top:2px;">copy now — this token will not be shown again</div> <div class="test-cmd-wrap svelte-x1i5gj"><button class="copy-btn svelte-x1i5gj"> </button> <pre class="test-cmd svelte-x1i5gj"> </pre></div></div>'),oe=i('<p class="muted">no users</p>'),le=i("<tr><td><a> </a></td><td><span> </span></td><td> </td><td> </td></tr>"),ve=i('<table><thead><tr><th>name</th><th>status</th><th>last active</th><th class="num">total cost</th></tr></thead><tbody></tbody></table>'),de=i('<p class="muted">no events yet</p>'),ie=i('<li><span class="ts"> </span> <span> </span> </li>'),ue=i('<ul class="event-list"></ul>'),_e=i('<span class="refresh"><button class="link">[refresh]</button> <span class="muted"> </span></span> <div class="sub"> <span> </span></div> <h2>usage</h2> <!>  <h2>claude accounts <a class="add-link">[+ add]</a></h2> <!> <h2>codex accounts <a class="add-link">[+ add]</a></h2> <!> <h2>users <!></h2> <!> <!> <!> <h2>recent events</h2> <!>',1);function we(mt,ot){Yt(ot,!0);let f=L(null),E=L(""),st=L(""),B=L(!1),W=L(""),H=L(!1),V=L(""),N=L(null),rt=L(!1);Ft(()=>{Ut()});async function Ut(){try{x(f,await Jt("/dashboard"),!0),x(st,new Date().toLocaleTimeString("en-GB",{hour12:!1}),!0)}catch(g){x(E,g.message,!0)}}function Vt(g){try{return new Date(g).toLocaleTimeString("en-GB",{hour12:!1})}catch{return g}}function Ot(){x(B,!1),x(W,""),x(V,"")}async function qt(){const g=t(W).trim();if(!g){x(V,"username required");return}x(H,!0),x(V,"");try{const C=await Jt("/users",{method:"POST",body:JSON.stringify({name:g})});x(N,{name:C.name,token:C.token},!0),t(f)&&(t(f).users=[...t(f).users,{id:C.id,name:C.name,status:"active",last_active_at:null,total_cost:0}]),x(B,!1),x(W,"")}catch(C){x(V,C.message,!0)}finally{x(H,!1)}}function Dt(g){return`ANTHROPIC_BASE_URL="${typeof window<"u"?window.location.origin:""}" \\
ANTHROPIC_AUTH_TOKEN="${g}" \\
claude -p --model haiku \\
  --system-prompt "You can only output bool" \\
  --tools "StructuredOutput" \\
  --setting-sources "" \\
  --strict-mcp-config \\
  --mcp-config '{"mcpServers":{}}' \\
  --disable-slash-commands \\
  --output-format stream-json \\
  --verbose \\
  --json-schema '{"type":"object","properties":{"result":{"type":"boolean"}},"required":["result"]}' \\
  "Print 'true' for testing purpose"`}async function Wt(){t(N)&&(await navigator.clipboard.writeText(Dt(t(N).token)),x(rt,!0),setTimeout(()=>{x(rt,!1)},2e3))}var Et=ga(),Xt=nt(Et);{var Zt=g=>{var C=Oa(),ut=e(C,!0);a(C),T(()=>d(ut,t(E))),v(g,C)},$t=g=>{var C=qa();v(g,C)},ta=g=>{const C=Q(()=>t(f).accounts.filter(o=>o.provider!=="codex")),ut=Q(()=>t(f).accounts.filter(o=>o.provider==="codex"));var Nt=_e(),ht=nt(Nt),It=e(ht),Pt=r(It,2),aa=e(Pt,!0);a(Pt),a(ht);var ft=r(ht,2),Rt=e(ft),bt=r(Rt),ea=e(bt,!0);a(bt),a(ft);var Bt=r(ft,4);{var sa=o=>{var l=Da();v(o,l)},ra=o=>{var l=Ia(),p=r(e(l));vt(p,23,()=>t(f).usage,c=>c.label,(c,s,h)=>{var b=Na(),_=e(b),S=e(_,!0);a(_);var m=r(_),k=e(m,!0);a(m);var A=r(m),w=e(A,!0);a(A);var U=r(A),z=e(U,!0);a(U);var G=r(U),J=e(G,!0);a(G);var O=r(G),X=e(O);{var K=q=>{var D=Ea(),Y=e(D,!0);a(D),T(F=>d(Y,F),[()=>Ct(t(s).cost_usd)]),v(q,D)},lt=q=>{var D=ya();T(Y=>d(D,Y),[()=>Ct(t(s).cost_usd)]),v(q,D)};j(X,q=>{t(h)===t(f).usage.length-1?q(K):q(lt,!1)})}a(O),a(b),T((q,D,Y,F)=>{d(S,t(s).label),d(k,q),d(w,D),d(z,Y),d(J,F)},[()=>_t(t(s).requests),()=>_t(t(s).input_tokens),()=>_t(t(s).output_tokens),()=>_t(t(s).cache_read_tokens)]),v(c,b)}),a(p),a(l),v(o,l)};j(Bt,o=>{t(f).usage.length===0?o(sa):o(ra,!1)})}var xt=r(Bt,2),na=r(e(xt));a(xt);var Ht=r(xt,2);{var oa=o=>{var l=Pa();v(o,l)},la=o=>{var l=Ka(),p=r(e(l));vt(p,21,()=>t(C),c=>c.id,(c,s)=>{var h=Ja(),b=e(h),_=e(b),S=e(_,!0);a(_),a(b);var m=r(b),k=e(m),A=e(k,!0);a(k),a(m);var w=r(m),U=e(w,!0),z=r(U);{var G=n=>{var u=Ra();v(n,u)};j(z,n=>{t(s).priority_mode==="auto"&&n(G)})}a(w);var J=r(w);Kt(J,{get until(){return t(s).overloaded_until}});var O=r(J),X=e(O,!0);a(O);var K=r(O),lt=e(K);{var q=n=>{var u=Ba();v(n,u)},D=n=>{const u=Q(()=>100-t(s).five_hour_util);var I=Ha(),y=nt(I),Z=e(y);a(y);var P=r(y,2),$=e(P,!0);a(P),T((tt,at)=>{R(y,1,tt,"svelte-x1i5gj"),d(Z,`${t(u)??""}%`),d($,at)},[()=>M(ct(t(u))),()=>pt(t(s).five_hour_reset,"5h")]),v(n,I)},Y=n=>{var u=La();v(n,u)};j(lt,n=>{t(s).status==="blocked"||t(s).status==="disabled"?n(q):t(s).five_hour_util!=null?n(D,1):n(Y,!1)})}a(K);var F=r(K),kt=e(F);{var wt=n=>{var u=Ma();v(n,u)},jt=n=>{const u=Q(()=>100-t(s).seven_day_util);var I=za(),y=nt(I),Z=e(y);a(y);var P=r(y,2),$=e(P,!0);a(P),T((tt,at)=>{R(y,1,tt,"svelte-x1i5gj"),d(Z,`${t(u)??""}%`),d($,at)},[()=>M(ct(t(u))),()=>pt(t(s).seven_day_reset,"7d")]),v(n,I)},Tt=n=>{var u=Ga();v(n,u)};j(kt,n=>{t(s).status==="blocked"||t(s).status==="disabled"?n(wt):t(s).seven_day_util!=null?n(jt,1):n(Tt,!1)})}a(F),a(h),T((n,u)=>{dt(_,"href",`${it??""}/accounts/${t(s).id??""}`),d(S,t(s).email),R(k,1,n,"svelte-x1i5gj"),d(A,t(s).status),d(U,t(s).priority),d(X,u)},[()=>M(St(t(s).status)),()=>At(t(s).last_used_at??"")]),v(c,h)}),a(p),a(l),v(o,l)};j(Ht,o=>{t(C).length===0?o(oa):o(la,!1)})}var gt=r(Ht,2),va=r(e(gt));a(gt);var Lt=r(gt,2);{var da=o=>{var l=Ya();v(o,l)},ia=o=>{var l=ae(),p=r(e(l));vt(p,21,()=>t(ut),c=>c.id,(c,s)=>{var h=te(),b=e(h),_=e(b),S=e(_,!0);a(_),a(b);var m=r(b),k=e(m),A=e(k,!0);a(k),a(m);var w=r(m),U=e(w,!0),z=r(U);{var G=n=>{var u=Fa();v(n,u)};j(z,n=>{t(s).priority_mode==="auto"&&n(G)})}a(w);var J=r(w);Kt(J,{get until(){return t(s).overloaded_until}});var O=r(J),X=e(O,!0);a(O);var K=r(O),lt=e(K);{var q=n=>{var u=Qa();v(n,u)},D=n=>{const u=Q(()=>100-t(s).five_hour_util);var I=Va(),y=nt(I),Z=e(y);a(y);var P=r(y,2),$=e(P,!0);a(P),T((tt,at)=>{R(y,1,tt,"svelte-x1i5gj"),d(Z,`${t(u)??""}%`),d($,at)},[()=>M(ct(t(u))),()=>pt(t(s).five_hour_reset,"5h")]),v(n,I)},Y=n=>{var u=Wa();v(n,u)};j(lt,n=>{t(s).status==="blocked"||t(s).status==="disabled"?n(q):t(s).five_hour_util!=null?n(D,1):n(Y,!1)})}a(K);var F=r(K),kt=e(F);{var wt=n=>{var u=Xa();v(n,u)},jt=n=>{const u=Q(()=>100-t(s).seven_day_util);var I=Za(),y=nt(I),Z=e(y);a(y);var P=r(y,2),$=e(P,!0);a(P),T((tt,at)=>{R(y,1,tt,"svelte-x1i5gj"),d(Z,`${t(u)??""}%`),d($,at)},[()=>M(ct(t(u))),()=>pt(t(s).seven_day_reset,"7d")]),v(n,I)},Tt=n=>{var u=$a();v(n,u)};j(kt,n=>{t(s).status==="blocked"||t(s).status==="disabled"?n(wt):t(s).seven_day_util!=null?n(jt,1):n(Tt,!1)})}a(F),a(h),T((n,u)=>{dt(_,"href",`${it??""}/accounts/${t(s).id??""}`),d(S,t(s).email),R(k,1,n,"svelte-x1i5gj"),d(A,t(s).status),d(U,t(s).priority),d(X,u)},[()=>M(St(t(s).status)),()=>At(t(s).last_used_at??"")]),v(c,h)}),a(p),a(l),v(o,l)};j(Lt,o=>{t(ut).length===0?o(da):o(ia,!1)})}var yt=r(Lt,2),ua=r(e(yt));{var _a=o=>{var l=ee();et("click",l,()=>{x(B,!0)}),v(o,l)};j(ua,o=>{!t(B)&&!t(N)&&o(_a)})}a(yt);var Mt=r(yt,2);{var ca=o=>{var l=re(),p=e(l);Ca(p);var c=r(p,2),s=r(c,2),h=r(s,2);{var b=_=>{var S=se(),m=e(S,!0);a(S),T(()=>d(m,t(V))),v(_,S)};j(h,_=>{t(V)&&_(b)})}a(l),T(()=>{p.disabled=t(H),c.disabled=t(H),s.disabled=t(H)}),et("keydown",p,_=>{_.key==="Enter"&&qt(),_.key==="Escape"&&Ot()}),Sa(p,()=>t(W),_=>x(W,_)),et("click",c,qt),et("click",s,Ot),v(o,l)};j(Mt,o=>{t(B)&&o(ca)})}var zt=r(Mt,2);{var pa=o=>{var l=ne(),p=e(l),c=r(e(p),2),s=e(c,!0);a(c);var h=r(c,2),b=e(h,!0);a(h);var _=r(h,2);a(p);var S=r(p,4),m=e(S),k=e(m,!0);a(m);var A=r(m,2),w=e(A,!0);a(A),a(S),a(l),T(U=>{d(s,t(N).name),d(b,t(N).token),d(k,t(rt)?"[copied]":"[copy]"),d(w,U)},[()=>Dt(t(N).token)]),et("click",_,()=>{x(N,null),x(rt,!1)}),et("click",m,Wt),v(o,l)};j(zt,o=>{t(N)&&o(pa)})}var Gt=r(zt,2);{var ma=o=>{var l=oe();v(o,l)},ha=o=>{var l=ve(),p=r(e(l));vt(p,21,()=>t(f).users,c=>c.id,(c,s)=>{var h=le(),b=e(h),_=e(b),S=e(_,!0);a(_),a(b);var m=r(b),k=e(m),A=e(k,!0);a(k),a(m);var w=r(m),U=e(w,!0);a(w);var z=r(w),G=e(z,!0);a(z),a(h),T((J,O,X)=>{dt(_,"href",`${it??""}/users/${t(s).id??""}`),d(S,t(s).name),R(k,1,J,"svelte-x1i5gj"),d(A,t(s).status),d(U,O),R(z,1,`num ${t(s).total_cost===0?"muted":""}`),d(G,X)},[()=>M(St(t(s).status)),()=>At(t(s).last_active_at??""),()=>Ct(t(s).total_cost)]),v(c,h)}),a(p),a(l),v(o,l)};j(Gt,o=>{t(f).users.length===0?o(ma):o(ha,!1)})}var fa=r(Gt,4);{var ba=o=>{var l=de();v(o,l)},xa=o=>{var l=ue();vt(l,21,()=>t(f).events,p=>p.ts,(p,c)=>{var s=ie(),h=e(s),b=e(h,!0);a(h);var _=r(h,2),S=e(_,!0);a(_);var m=r(_);a(s),T((k,A,w)=>{d(b,k),R(_,1,A,"svelte-x1i5gj"),d(S,w),d(m,` ${t(c).message??""}`)},[()=>Vt(t(c).ts),()=>M(Ta(t(c).type)),()=>t(c).type.toUpperCase()]),v(p,s)}),a(l),v(o,l)};j(fa,o=>{t(f).events.length===0?o(ba):o(xa,!1)})}T(()=>{d(aa,t(st)),d(Rt,`${t(f).health.version??""} · up ${t(f).health.uptime??""} · sqlite `),R(bt,1,M(t(f).health.sqlite==="ok"?"g":"r")),d(ea,t(f).health.sqlite),dt(na,"href",`${it??""}/add-account`),dt(va,"href",`${it??""}/add-account`)}),et("click",It,Ut),v(g,Nt)};j(Xt,g=>{t(E)?g(Zt):t(f)?g(ta,!1):g($t,1)})}v(mt,Et),Qt()}ja(["click","keydown"]);export{we as component,ke as universal};
