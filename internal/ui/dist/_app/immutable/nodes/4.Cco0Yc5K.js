import{a as c,f as u}from"../chunks/YPNk2NX5.js";import{b as ha,e as t,f as J,m as x,g as a,d as fa,j as s,aa as H,k as o,n as r,s as d}from"../chunks/ABNvuIHC.js";import{d as ga,a as M,s as p}from"../chunks/e87nZPu-.js";import{i as k}from"../chunks/CCxA75cu.js";import{r as K,s as N}from"../chunks/ct8flr_T.js";import{b as ea,a as ma}from"../chunks/2sA3hMLD.js";import{b as ta}from"../chunks/B36JXrSm.js";import{a as ra}from"../chunks/DtH33QRI.js";const xa=!1,Ma=Object.freeze(Object.defineProperty({__proto__:null,ssr:xa},Symbol.toStringTag,{value:"Module"}));var ka=u('<span class="g">&#10003;</span>'),ya=u('<p class="error-msg"> </p>'),Oa=u('<p class="hint">generate an OAuth URL, open it in browser, login and authorize.</p> <button class="link"> </button> <!>',1),wa=u('<div class="bar">session: <b> </b> <span class="muted">(expires in 10m)</span> <br/><br/> auth url:<br/> <a target="_blank" class="auth-url"> </a> <br/><br/> <span class="muted">open this URL, login and authorize. then paste the callback below.</span></div>'),za=u('<span class="g">&#10003;</span>'),Sa=u('<p class="error-msg"> </p>'),Ua=u('<label for="callback-input">callback url or code</label> <input id="callback-input" type="text"/> <p class="hint"> </p> <!> <button class="link"> </button>',1),ja=u('<div class="bar"><span class="g">&#10003; account created</span> <br/><br/> email: <b> </b><br/> status: <b class="g"> </b><br/> <br/> <a>view account &rarr;</a></div>'),Ca=u("<h2>exchange code <!></h2> <!>",1),Pa=u('<h2>add account</h2> <div class="bar" style="margin-bottom:12px"><label style="margin-right:12px"><input type="radio"/> Claude</label> <label><input type="radio"/> Codex</label></div> <h2>authorize <!></h2> <!> <!> <p style="margin-top:16px;font-size:12px"><a>&larr; back</a></p>',1);function Na(sa,oa){ha(oa,!0);const Q=[];let h=d("claude"),E=d(!1),I=d(!1),v=d(""),L=d(""),y=d(""),z=d(""),S=d(""),f=d(null);async function la(){r(E,!0),r(z,"");try{const e=await ra(`/accounts/generate-auth-url?provider=${a(h)}`,{method:"POST"});r(v,e.session_id,!0),r(L,e.auth_url,!0)}catch(e){r(z,e.message,!0)}finally{r(E,!1)}}async function na(){if(a(y).trim()){r(I,!0),r(S,"");try{const e=await ra("/accounts/exchange-code",{method:"POST",body:JSON.stringify({session_id:a(v),callback_url:a(y).trim()})});r(f,e,!0)}catch(e){r(S,e.message,!0)}finally{r(I,!1)}}}function V(){r(v,""),r(L,""),r(y,""),r(z,""),r(S,""),r(f,null)}var W=Pa(),q=t(J(W),2),B=s(q),O=s(B);K(O),O.value=O.__value="claude",H(),o(B);var X=t(B,2),w=s(X);K(w),w.value=w.__value="codex",H(),o(X),o(q);var D=t(q,2),ia=t(s(D));{var ca=e=>{var i=ka();c(e,i)};k(ia,e=>{a(v)&&e(ca)})}o(D);var Y=t(D,2);{var ua=e=>{var i=Oa(),l=t(J(i),2),U=s(l,!0);o(l);var g=t(l,2);{var j=C=>{var P=ya(),n=s(P,!0);o(P),x(()=>p(n,a(z))),c(C,P)};k(g,C=>{a(z)&&C(j)})}x(()=>{l.disabled=a(E),p(U,a(E)?"[generating...]":"[generate auth url]")}),M("click",l,la),c(e,i)},va=e=>{var i=wa(),l=t(s(i)),U=s(l,!0);o(l);var g=t(l,9),j=s(g,!0);o(g),H(5),o(i),x(()=>{p(U,a(v)),N(g,"href",a(L)),p(j,a(L))}),c(e,i)};k(Y,e=>{a(v)?e(va,!1):e(ua)})}var Z=t(Y,2);{var da=e=>{var i=Ca(),l=J(i),U=t(s(l));{var g=n=>{var b=za();c(n,b)};k(U,n=>{a(f)&&n(g)})}o(l);var j=t(l,2);{var C=n=>{var b=Ua(),_=t(J(b),2);K(_);var T=t(_,2),A=s(T,!0);o(T);var R=t(T,2);{var F=m=>{var G=Sa(),_a=s(G,!0);o(G),x(()=>p(_a,a(S))),c(m,G)};k(R,m=>{a(S)&&m(F)})}var $=t(R,2),ba=s($,!0);o($),x(m=>{N(_,"placeholder",a(h)==="codex"?"http://localhost:1455/auth/callback?code=...":"https://platform.claude.com/oauth/code/callback?code=..."),p(A,a(h)==="codex"?"account info is extracted from the id_token.":"email and org info are auto-fetched after token exchange."),$.disabled=m,p(ba,a(I)?"[exchanging...]":"[exchange code]")},[()=>a(I)||!a(y).trim()]),ma(_,()=>a(y),m=>r(y,m)),M("click",$,na),c(n,b)},P=n=>{var b=ja(),_=t(s(b),5),T=s(_,!0);o(_);var A=t(_,3),R=s(A,!0);o(A);var F=t(A,5);o(b),x(()=>{p(T,a(f).email),p(R,a(f).status),N(F,"href",`${ta??""}/accounts/${a(f).id??""}`)}),c(n,b)};k(j,n=>{a(f)?n(P,!1):n(C)})}c(e,i)};k(Z,e=>{a(v)&&e(da)})}var aa=t(Z,2),pa=s(aa);o(aa),x(()=>{O.disabled=!!a(v),w.disabled=!!a(v),N(pa,"href",`${ta??""}/dashboard`)}),M("change",O,V),ea(Q,[],O,()=>a(h),e=>r(h,e)),M("change",w,V),ea(Q,[],w,()=>a(h),e=>r(h,e)),c(sa,W),fa()}ga(["change","click"]);export{Na as component,Ma as universal};
