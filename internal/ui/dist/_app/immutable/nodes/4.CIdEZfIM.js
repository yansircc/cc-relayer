import{d as Et,c as Mt,a as l,s as v,b as D,f as c,t as wa}from"../chunks/Ce1JsnIe.js";import{a1 as Ot,a4 as It,s as w,g as t,a5 as T,a7 as Ut,a2 as E,a9 as d,aa as o,a8 as n,a6 as h,ac as P,aj as Lt}from"../chunks/BLL442xA.js";import{i as g}from"../chunks/BBj9_ryw.js";import{e as ka,i as Da}from"../chunks/CrcuVASb.js";import{s as Sa,r as Rt}from"../chunks/BXgLrMXN.js";import{c as M,s as O}from"../chunks/CQtkrdUT.js";import{b as Nt}from"../chunks/C1SpsZ0d.js";import{s as Pt,a as zt}from"../chunks/Dh3P-UHa.js";import{p as Ht}from"../chunks/CtzWjIl6.js";import{g as Bt}from"../chunks/BasH8Q2U.js";import{b as da}from"../chunks/BE41A0-c.js";import{a as S}from"../chunks/0xq203u2.js";import{a as Ct,t as na}from"../chunks/C5Uh6Ygl.js";const Gt=!1,De=Object.freeze(Object.defineProperty({__proto__:null,ssr:Gt},Symbol.toStringTag,{value:"Module"}));var Jt=c('<p class="error-msg"> </p> <p><a>&larr; back to accounts</a></p>',1),Ft=c('<p class="loading">loading account...</p>'),qt=c(' <span class="muted"> </span>',1),Kt=c('<span class="muted">-</span>'),Qt=c('<span class="muted">-</span>'),Vt=c('<span class="g">ok</span>'),Wt=c('<span class="r">expired</span>'),Xt=c('<span class="o"> </span>'),Yt=c('<span class="muted">-</span>'),Zt=c('<span class="o"> </span>'),ae=c('<span class="muted">-</span>'),te=c('<span class="muted">-</span>'),ee=c('<span class="r"> </span>'),re=c('<span class="muted">-</span>'),se=c("<dt> </dt> <dd> </dd>",1),oe=c("<dl></dl>"),de=c('<p class="muted">not captured yet</p>'),ne=c('<p class="muted">no active session bindings</p>'),ie=c('<tr><td class="muted"> </td><td> </td><td> </td><td><a href="javascript:void(0)" style="font-size:12px">unbind</a></td></tr>'),le=c("<table><thead><tr><th>session uuid</th><th>last active</th><th>ttl</th><th></th></tr></thead><tbody></tbody></table>"),ve=c('<h2> <span> </span></h2> <div class="actions"><a href="javascript:void(0)">[force refresh token]</a> <a href="javascript:void(0)"> </a> <a href="javascript:void(0)" class="r">[delete]</a></div> <h2>info</h2> <dl><dt>id</dt> <dd class="muted"> </dd> <dt>email</dt> <dd> </dd> <dt>org</dt> <dd><!></dd> <dt>priority</dt> <dd><input class="pri-edit svelte-xw1yjl" type="text"/> <a href="javascript:void(0)" style="font-size:12px"> </a></dd> <dt>created</dt> <dd> </dd></dl> <h2>token</h2> <dl><dt>access token expires</dt> <dd> </dd> <dt>last refreshed</dt> <dd><!></dd> <dt>refresh status</dt> <dd><!></dd></dl> <h2>scheduling</h2> <dl><dt>schedulable</dt> <dd> </dd> <dt>overloaded until</dt> <dd><!></dd> <dt>5h window</dt> <dd><span> </span></dd> <dt>opus rate limit</dt> <dd><!></dd> <dt>last used</dt> <dd><!></dd> <dt>error message</dt> <dd><!></dd></dl> <h2>stainless fingerprint</h2> <!> <h2>bound sessions <span class="muted"> </span></h2> <!> <p style="margin-top:16px;font-size:12px"><a>&larr; back to accounts</a></p>',1);function Se(ja,Aa){Ot(Aa,!0);const $a=()=>Pt(Ht,"$page",Ta),[Ta,Ea]=zt();let e=E(null),z=E(""),ia=E(!0),I=E(""),H=E(!1);It(()=>{la()});async function la(){try{w(e,await S("/accounts/"+$a().params.id),!0),w(I,String(t(e).priority),!0)}catch(s){w(z,s.message,!0)}finally{w(ia,!1)}}function Ma(s){return s==="active"?"tag tag-active":s==="blocked"?"tag tag-blocked":s==="overloaded"?"tag tag-overloaded":s==="disabled"?"tag tag-disabled":"tag"}function Oa(s){const i=s-Date.now();if(i<=0)return{text:"expired",cls:"r"};const u=Math.floor(i/1e3),m=Math.floor(u/60),y=u%60,x=`${m}m ${String(y).padStart(2,"0")}s remaining`;return m<60?{text:x,cls:m<10?"r":"o"}:{text:x,cls:"g"}}function va(s){if(!s)return"-";const i=new Date(s).getTime()-Date.now();if(i<=0)return"passed";const u=Math.floor(i/6e4);return u<60?`${u}m`:`${Math.floor(u/60)}h ${u%60}m`}function Ia(s){if(!s)return"-";const i=new Date(s).getTime()-Date.now();if(i<=0)return"expired";const u=Math.floor(i/6e4);return u<60?`${u}m`:`${Math.floor(u/60)}h ${u%60}m`}function Ua(s){return s==="allowed"?"g":s==="stopped"||s==="warning"?"o":"r"}async function ca(){if(!t(e))return;const s=parseInt(t(I));if(!isNaN(s)){w(H,!0);try{await S(`/accounts/${t(e).id}/priority`,{method:"POST",body:JSON.stringify({priority:s})}),t(e).priority=s}catch(i){alert(i.message)}finally{w(H,!1)}}}async function La(){if(t(e))try{await S(`/accounts/${t(e).id}/refresh`,{method:"POST"}),await la()}catch(s){alert(s.message)}}async function Ra(){if(!t(e))return;const s=t(e).status==="disabled"?"active":"disabled";try{await S(`/accounts/${t(e).id}/status`,{method:"POST",body:JSON.stringify({status:s})}),t(e).status=s}catch(i){alert(i.message)}}async function Na(){if(t(e)&&confirm(`Delete account ${t(e).name}?`))try{await S(`/accounts/${t(e).id}`,{method:"DELETE"}),Bt(`${da}/accounts`)}catch(s){alert(s.message)}}async function Pa(s){if(t(e))try{await S(`/sessions/binding/${s}`,{method:"DELETE"}),t(e).sessions=t(e).sessions.filter(i=>i.session_uuid!==s)}catch(i){alert(i.message)}}var ua=Mt(),za=T(ua);{var Ha=s=>{var i=Jt(),u=T(i),m=d(u,!0);o(u);var y=n(u,2),x=d(y);o(y),h(()=>{v(m,t(z)),Sa(x,"href",`${da??""}/accounts`)}),l(s,i)},Ba=s=>{var i=Ft();l(s,i)},Ca=s=>{const i=P(()=>Oa(t(e).expiresAt));var u=ve(),m=T(u),y=d(m),x=n(y),Ga=d(x,!0);o(x),o(m);var B=n(m,2),fa=d(B),j=n(fa,2),Ja=d(j);o(j);var Fa=n(j,2);o(B);var C=n(B,4),G=n(d(C),2),qa=d(G,!0);o(G);var J=n(G,4),Ka=d(J,!0);o(J);var F=n(J,4),Qa=d(F);{var Va=a=>{var r=qt(),f=T(r),p=n(f),_=d(p);o(p),h(()=>{v(f,`${t(e).extInfo.orgName??""} `),v(_,`(uuid: ${t(e).extInfo.orgUUID??""})`)}),l(a,r)},Wa=a=>{var r=Kt();l(a,r)};g(Qa,a=>{t(e).extInfo?a(Va):a(Wa,!1)})}o(F);var q=n(F,4),U=d(q);Rt(U);var K=n(U,2),Xa=d(K,!0);o(K),o(q);var pa=n(q,4),Ya=d(pa,!0);o(pa),o(C);var Q=n(C,4),L=n(d(Q),2),Za=d(L,!0);o(L);var V=n(L,4),at=d(V);{var tt=a=>{var r=wa();h((f,p)=>v(r,`${f??""} (${p??""})`),[()=>na(t(e).lastRefreshAt),()=>new Date(t(e).lastRefreshAt).toLocaleTimeString("en-GB",{hour12:!1})]),l(a,r)},et=a=>{var r=Qt();l(a,r)};g(at,a=>{t(e).lastRefreshAt?a(tt):a(et,!1)})}o(V);var _a=n(V,4),rt=d(_a);{var st=a=>{var r=Vt();l(a,r)},ot=P(()=>t(e).expiresAt>Date.now()),dt=a=>{var r=Wt();l(a,r)};g(rt,a=>{t(ot)?a(st):a(dt,!1)})}o(_a),o(Q);var W=n(Q,4),R=n(d(W),2),nt=d(R,!0);o(R);var X=n(R,4),it=d(X);{var lt=a=>{var r=Xt(),f=d(r,!0);o(r),h(p=>v(f,p),[()=>va(t(e).overloadedUntil)]),l(a,r)},vt=a=>{var r=Yt();l(a,r)};g(it,a=>{t(e).overloadedUntil?a(lt):a(vt,!1)})}o(X);var Y=n(X,4),Z=d(Y),ct=d(Z,!0);o(Z),o(Y);var aa=n(Y,4),ut=d(aa);{var ft=a=>{var r=Zt(),f=d(r,!0);o(r),h(p=>v(f,p),[()=>va(t(e).opusRateLimitEndAt)]),l(a,r)},pt=a=>{var r=ae();l(a,r)};g(ut,a=>{t(e).opusRateLimitEndAt?a(ft):a(pt,!1)})}o(aa);var ta=n(aa,4),_t=d(ta);{var mt=a=>{var r=wa();h((f,p)=>v(r,`${f??""} (${p??""})`),[()=>na(t(e).lastUsedAt),()=>new Date(t(e).lastUsedAt).toLocaleTimeString("en-GB",{hour12:!1})]),l(a,r)},ht=a=>{var r=te();l(a,r)};g(_t,a=>{t(e).lastUsedAt?a(mt):a(ht,!1)})}o(ta);var ma=n(ta,4),gt=d(ma);{var xt=a=>{var r=ee(),f=d(r,!0);o(r),h(()=>v(f,t(e).errorMessage)),l(a,r)},yt=a=>{var r=re();l(a,r)};g(gt,a=>{t(e).errorMessage?a(xt):a(yt,!1)})}o(ma),o(W);var ha=n(W,4);{var bt=a=>{var r=oe();ka(r,21,()=>Object.entries(t(e).stainless),Da,(f,p)=>{var _=P(()=>Lt(t(p),2));let A=()=>t(_)[0],$=()=>t(_)[1];var N=se(),b=T(N),ra=d(b,!0);o(b);var k=n(b,2),sa=d(k,!0);o(k),h(()=>{v(ra,A()),v(sa,$())}),l(f,N)}),o(r),l(a,r)},wt=P(()=>t(e).stainless&&Object.keys(t(e).stainless).length>0),kt=a=>{var r=de();l(a,r)};g(ha,a=>{t(wt)?a(bt):a(kt,!1)})}var ea=n(ha,2),ga=n(d(ea)),Dt=d(ga);o(ga),o(ea);var xa=n(ea,2);{var St=a=>{var r=ne();l(a,r)},jt=a=>{var r=le(),f=n(d(r));ka(f,21,()=>t(e).sessions,Da,(p,_)=>{var A=ie(),$=d(A),N=d($,!0);o($);var b=n($),ra=d(b,!0);o(b);var k=n(b),sa=d(k,!0);o(k);var ba=n(k),$t=d(ba);o(ba),o(A),h((oa,Tt)=>{v(N,t(_).session_uuid),v(ra,oa),v(sa,Tt)},[()=>na(t(_).last_used_at),()=>Ia(t(_).expires_at)]),D("click",$t,oa=>{oa.preventDefault(),Pa(t(_).session_uuid)}),l(p,A)}),o(f),o(r),l(a,r)};g(xa,a=>{t(e).sessions.length===0?a(St):a(jt,!1)})}var ya=n(xa,2),At=d(ya);o(ya),h((a,r,f)=>{var p,_;v(y,`${((p=t(e).extInfo)==null?void 0:p.email)??t(e).name??""} `),O(x,1,a,"svelte-xw1yjl"),v(Ga,t(e).status),O(j,1,M(t(e).status==="disabled"?"g":"r")),v(Ja,`[${t(e).status==="disabled"?"enable":"disable"}]`),v(qa,t(e).id),v(Ka,((_=t(e).extInfo)==null?void 0:_.email)??"-"),v(Xa,t(H)?"saving...":"[save]"),v(Ya,r),O(L,1,M(t(i).cls),"svelte-xw1yjl"),v(Za,t(i).text),O(R,1,M(t(e).schedulable?"g":"r")),v(nt,t(e).schedulable?"yes":"no"),O(Z,1,f,"svelte-xw1yjl"),v(ct,t(e).fiveHourStatus),v(Dt,`(${t(e).sessions.length??""})`),Sa(At,"href",`${da??""}/accounts`)},[()=>M(Ma(t(e).status)),()=>Ct(t(e).createdAt),()=>M(Ua(t(e).fiveHourStatus))]),D("click",fa,a=>{a.preventDefault(),La()}),D("click",j,a=>{a.preventDefault(),Ra()}),D("click",Fa,a=>{a.preventDefault(),Na()}),D("keydown",U,a=>{a.key==="Enter"&&ca()}),Nt(U,()=>t(I),a=>w(I,a)),D("click",K,a=>{a.preventDefault(),ca()}),l(s,u)};g(za,s=>{t(z)?s(Ha):t(ia)?s(Ba,1):t(e)&&s(Ca,2)})}l(ja,ua),Ut(),Ea()}Et(["click","keydown"]);export{Se as component,De as universal};
