import{a as v,f as i,c as ga,t as ya}from"../chunks/YPNk2NX5.js";import{b as Ft,s as H,w as ka,ab as Qt,g as t,n as x,ad as wa,j as e,k as a,m as T,d as Vt,ac as Q,f as rt,e as r}from"../chunks/ABNvuIHC.js";import{s as d,d as ja,a as st}from"../chunks/e87nZPu-.js";import{i as j}from"../chunks/CCxA75cu.js";import{s as P,c as L,e as it,b as mt,d as Ut,i as Ot,a as qt,r as ht,j as ft,k as Ta}from"../chunks/cNbZ-Ql0.js";import{s as ut,r as Sa}from"../chunks/ct8flr_T.js";import{a as Ca}from"../chunks/2sA3hMLD.js";import{b as _t}from"../chunks/DmuWyb2n.js";import{a as Kt}from"../chunks/DtH33QRI.js";const Aa=!1,ke=Object.freeze(Object.defineProperty({__proto__:null,ssr:Aa},Symbol.toStringTag,{value:"Module"}));var Ua=i("<td> </td>");function Yt(bt,nt){Ft(nt,!0);let f=H(ka(Date.now())),N=null,ot=Q(()=>nt.until?new Date(nt.until).getTime()-t(f):0),R=Q(()=>t(ot)>0),W=Q(()=>{if(!t(R))return"–";const O=Math.floor(t(ot)/1e3),X=O%60,lt=Math.floor(O/60),ct=lt%60,vt=Math.floor(lt/60);return vt>0?`${vt}h ${ct}m ${String(X).padStart(2,"0")}s`:`${ct}m ${String(X).padStart(2,"0")}s`});Qt(()=>{t(R)&&!N?N=setInterval(()=>{x(f,Date.now(),!0)},1e3):!t(R)&&N&&(clearInterval(N),N=null)}),wa(()=>{N&&clearInterval(N)});var B=Ua(),V=e(B,!0);a(B),T(()=>{P(B,1,L(t(R)?"o":"muted")),d(V,t(W))}),v(bt,B),Vt()}var Oa=i('<p class="error-msg"> </p>'),qa=i('<p class="loading">loading dashboard...</p>'),Da=i('<p class="muted">no usage data yet</p>'),Ea=i("<b> </b>"),Na=i('<tr><td> </td><td class="num"> </td><td class="num"> </td><td class="num"> </td><td class="num"> </td><td class="num"><!></td></tr>'),Ia=i('<table><thead><tr><th></th><th class="num">requests</th><th class="num">input</th><th class="num">output</th><th class="num">cache read</th><th class="num">cost</th></tr></thead><tbody></tbody></table>'),Ma=i('<p class="muted">no claude accounts</p>'),Pa=i('<span class="muted">(a)</span>'),Ra=i('<span class="muted">&ndash;</span>'),Ba=i('<span> </span> <span class="muted"> </span>',1),Ha=i('<span class="muted">&ndash;</span>'),La=i('<span class="muted">&ndash;</span>'),za=i('<span> </span> <span class="muted"> </span>',1),Ga=i('<span class="muted">&ndash;</span>'),Ja=i('<tr><td><a> </a></td><td><span> </span></td><td> <!></td><!><td> </td><td class="num"><!></td><td class="num"><!></td></tr>'),Ka=i('<table><thead><tr><th>email</th><th>status</th><th>pri</th><th>cooldown</th><th>last used</th><th class="num">5h remain</th><th class="num">7d remain</th></tr></thead><tbody></tbody></table>'),Ya=i('<p class="muted">no codex accounts</p>'),Fa=i('<span class="muted">(a)</span>'),Qa=i('<span class="muted">&ndash;</span>'),Va=i('<span> </span> <span class="muted"> </span>',1),Wa=i('<span class="muted">&ndash;</span>'),Xa=i('<span class="muted">&ndash;</span>'),Za=i('<span> </span> <span class="muted"> </span>',1),$a=i('<span class="muted">&ndash;</span>'),te=i('<tr><td><a> </a></td><td><span> </span></td><td> <!></td><!><td> </td><td class="num"><!></td><td class="num"><!></td></tr>'),ae=i('<table><thead><tr><th>email</th><th>status</th><th>pri</th><th>cooldown</th><th>last used</th><th class="num">primary</th><th class="num">secondary</th></tr></thead><tbody></tbody></table>'),ee=i('<button class="link add-link">[+ add]</button>'),se=i('<span class="r" style="margin-left:8px;"> </span>'),re=i('<div class="bar"><input type="text" placeholder="username" style="width:160px;max-width:160px;margin-right:6px;"/> <button class="link">[create]</button> <button class="link">[cancel]</button> <!></div>'),ne=i('<div class="bar"><div><span class="g">&#10003; created</span> <b> </b> &mdash; token: <span style="user-select:all;"> </span> <button class="link">[dismiss]</button></div> <div class="r" style="font-size:11px;margin-top:2px;">copy now — this token will not be shown again</div> <div class="test-cmd-wrap svelte-x1i5gj"><button class="copy-btn svelte-x1i5gj"> </button> <pre class="test-cmd svelte-x1i5gj"> </pre></div></div>'),oe=i('<p class="muted">no users</p>'),le=i("<tr><td><a> </a></td><td><span> </span></td><td> </td><td> </td></tr>"),ve=i('<table><thead><tr><th>name</th><th>status</th><th>last active</th><th class="num">total cost</th></tr></thead><tbody></tbody></table>'),de=i('<p class="muted">no events yet</p>'),ie=i('<li><span class="ts"> </span> <span> </span> </li>'),ue=i('<ul class="event-list"></ul>'),_e=i('<span class="refresh"><button class="link">[refresh]</button> <span class="muted"> </span></span> <div class="sub"> <span> </span></div> <h2>usage</h2> <!>  <h2>claude accounts <a class="add-link">[+ add]</a></h2> <!> <h2>codex accounts <a class="add-link">[+ add]</a></h2> <!> <h2>users <!></h2> <!> <!> <!> <h2>recent events</h2> <!>',1);function we(bt,nt){Ft(nt,!0);let f=H(null),N=H(""),ot=H(""),R=H(!1),W=H(""),B=H(!1),V=H(""),O=H(null),X=H(!1);Qt(()=>{lt()});async function lt(){try{x(f,await Kt("/dashboard"),!0),x(ot,new Date().toLocaleTimeString("en-GB",{hour12:!1}),!0)}catch(g){x(N,g.message,!0)}}function ct(g){try{return new Date(g).toLocaleTimeString("en-GB",{hour12:!1})}catch{return g}}function vt(){x(R,!1),x(W,""),x(V,"")}async function Dt(){const g=t(W).trim();if(!g){x(V,"username required");return}x(B,!0),x(V,"");try{const S=await Kt("/users",{method:"POST",body:JSON.stringify({name:g})});x(O,{name:S.name,token:S.token},!0),t(f)&&(t(f).users=[...t(f).users,{id:S.id,name:S.name,status:"active",last_active_at:null,total_cost:0}]),x(R,!1),x(W,"")}catch(S){x(V,S.message,!0)}finally{x(B,!1)}}function Et(g){return`ANTHROPIC_BASE_URL="${typeof window<"u"?window.location.origin:""}" \\
ANTHROPIC_AUTH_TOKEN="${g}" \\
claude -p --model haiku \\
  --system-prompt "You can only output bool" \\
  --tools "StructuredOutput" \\
  --setting-sources "" \\
  --strict-mcp-config \\
  --mcp-config '{"mcpServers":{}}' \\
  --disable-slash-commands \\
  --output-format stream-json \\
  --verbose \\
  --json-schema '{"type":"object","properties":{"result":{"type":"boolean"}},"required":["result"]}' \\
  "Print 'true' for testing purpose"`}async function Wt(){t(O)&&(await navigator.clipboard.writeText(Et(t(O).token)),x(X,!0),setTimeout(()=>{x(X,!1)},2e3))}var Nt=ga(),Xt=rt(Nt);{var Zt=g=>{var S=Oa(),pt=e(S,!0);a(S),T(()=>d(pt,t(N))),v(g,S)},$t=g=>{var S=qa();v(g,S)},ta=g=>{const S=Q(()=>t(f).accounts.filter(o=>o.provider!=="codex")),pt=Q(()=>t(f).accounts.filter(o=>o.provider==="codex"));var It=_e(),xt=rt(It),Mt=e(xt),Pt=r(Mt,2),aa=e(Pt,!0);a(Pt),a(xt);var gt=r(xt,2),Rt=e(gt),yt=r(Rt),ea=e(yt,!0);a(yt),a(gt);var Bt=r(gt,4);{var sa=o=>{var l=Da();v(o,l)},ra=o=>{var l=Ia(),p=r(e(l));it(p,23,()=>t(f).usage,c=>c.label,(c,s,h)=>{var b=Na(),_=e(b),C=e(_,!0);a(_);var m=r(_),k=e(m,!0);a(m);var A=r(m),w=e(A,!0);a(A);var U=r(A),z=e(U,!0);a(U);var G=r(U),J=e(G,!0);a(G);var q=r(G),Z=e(q);{var K=D=>{var E=Ea(),Y=e(E,!0);a(E),T(F=>d(Y,F),[()=>Ut(t(s).cost_usd)]),v(D,E)},dt=D=>{var E=ya();T(Y=>d(E,Y),[()=>Ut(t(s).cost_usd)]),v(D,E)};j(Z,D=>{t(h)===t(f).usage.length-1?D(K):D(dt,!1)})}a(q),a(b),T((D,E,Y,F)=>{d(C,t(s).label),d(k,D),d(w,E),d(z,Y),d(J,F)},[()=>mt(t(s).requests),()=>mt(t(s).input_tokens),()=>mt(t(s).output_tokens),()=>mt(t(s).cache_read_tokens)]),v(c,b)}),a(p),a(l),v(o,l)};j(Bt,o=>{t(f).usage.length===0?o(sa):o(ra,!1)})}var kt=r(Bt,2),na=r(e(kt));a(kt);var Ht=r(kt,2);{var oa=o=>{var l=Ma();v(o,l)},la=o=>{var l=Ka(),p=r(e(l));it(p,21,()=>t(S),c=>c.id,(c,s)=>{var h=Ja(),b=e(h),_=e(b),C=e(_,!0);a(_),a(b);var m=r(b),k=e(m),A=e(k,!0);a(k),a(m);var w=r(m),U=e(w,!0),z=r(U);{var G=n=>{var u=Pa();v(n,u)};j(z,n=>{t(s).priority_mode==="auto"&&n(G)})}a(w);var J=r(w);Yt(J,{get until(){return t(s).overloaded_until}});var q=r(J),Z=e(q,!0);a(q);var K=r(q),dt=e(K);{var D=n=>{var u=Ra();v(n,u)},E=n=>{const u=Q(()=>100-t(s).five_hour_util);var I=Ba(),y=rt(I),$=e(y);a(y);var M=r(y,2),tt=e(M,!0);a(M),T((at,et)=>{P(y,1,at,"svelte-x1i5gj"),d($,`${t(u)??""}%`),d(tt,et)},[()=>L(ht(t(u))),()=>ft(t(s).five_hour_reset)]),v(n,I)},Y=n=>{var u=Ha();v(n,u)};j(dt,n=>{t(s).status==="blocked"||t(s).status==="disabled"?n(D):t(s).five_hour_util!=null?n(E,1):n(Y,!1)})}a(K);var F=r(K),Tt=e(F);{var St=n=>{var u=La();v(n,u)},Ct=n=>{const u=Q(()=>100-t(s).seven_day_util);var I=za(),y=rt(I),$=e(y);a(y);var M=r(y,2),tt=e(M,!0);a(M),T((at,et)=>{P(y,1,at,"svelte-x1i5gj"),d($,`${t(u)??""}%`),d(tt,et)},[()=>L(ht(t(u))),()=>ft(t(s).seven_day_reset)]),v(n,I)},At=n=>{var u=Ga();v(n,u)};j(Tt,n=>{t(s).status==="blocked"||t(s).status==="disabled"?n(St):t(s).seven_day_util!=null?n(Ct,1):n(At,!1)})}a(F),a(h),T((n,u)=>{ut(_,"href",`${_t??""}/accounts/${t(s).id??""}`),d(C,t(s).email),P(k,1,n,"svelte-x1i5gj"),d(A,t(s).status),d(U,t(s).priority),d(Z,u)},[()=>L(Ot(t(s).status)),()=>qt(t(s).last_used_at??"")]),v(c,h)}),a(p),a(l),v(o,l)};j(Ht,o=>{t(S).length===0?o(oa):o(la,!1)})}var wt=r(Ht,2),va=r(e(wt));a(wt);var Lt=r(wt,2);{var da=o=>{var l=Ya();v(o,l)},ia=o=>{var l=ae(),p=r(e(l));it(p,21,()=>t(pt),c=>c.id,(c,s)=>{var h=te(),b=e(h),_=e(b),C=e(_,!0);a(_),a(b);var m=r(b),k=e(m),A=e(k,!0);a(k),a(m);var w=r(m),U=e(w,!0),z=r(U);{var G=n=>{var u=Fa();v(n,u)};j(z,n=>{t(s).priority_mode==="auto"&&n(G)})}a(w);var J=r(w);Yt(J,{get until(){return t(s).overloaded_until}});var q=r(J),Z=e(q,!0);a(q);var K=r(q),dt=e(K);{var D=n=>{var u=Qa();v(n,u)},E=n=>{const u=Q(()=>100-t(s).five_hour_util);var I=Va(),y=rt(I),$=e(y);a(y);var M=r(y,2),tt=e(M,!0);a(M),T((at,et)=>{P(y,1,at,"svelte-x1i5gj"),d($,`${t(u)??""}%`),d(tt,et)},[()=>L(ht(t(u))),()=>ft(t(s).five_hour_reset)]),v(n,I)},Y=n=>{var u=Wa();v(n,u)};j(dt,n=>{t(s).status==="blocked"||t(s).status==="disabled"?n(D):t(s).five_hour_util!=null?n(E,1):n(Y,!1)})}a(K);var F=r(K),Tt=e(F);{var St=n=>{var u=Xa();v(n,u)},Ct=n=>{const u=Q(()=>100-t(s).seven_day_util);var I=Za(),y=rt(I),$=e(y);a(y);var M=r(y,2),tt=e(M,!0);a(M),T((at,et)=>{P(y,1,at,"svelte-x1i5gj"),d($,`${t(u)??""}%`),d(tt,et)},[()=>L(ht(t(u))),()=>ft(t(s).seven_day_reset)]),v(n,I)},At=n=>{var u=$a();v(n,u)};j(Tt,n=>{t(s).status==="blocked"||t(s).status==="disabled"?n(St):t(s).seven_day_util!=null?n(Ct,1):n(At,!1)})}a(F),a(h),T((n,u)=>{ut(_,"href",`${_t??""}/accounts/${t(s).id??""}`),d(C,t(s).email),P(k,1,n,"svelte-x1i5gj"),d(A,t(s).status),d(U,t(s).priority),d(Z,u)},[()=>L(Ot(t(s).status)),()=>qt(t(s).last_used_at??"")]),v(c,h)}),a(p),a(l),v(o,l)};j(Lt,o=>{t(pt).length===0?o(da):o(ia,!1)})}var jt=r(Lt,2),ua=r(e(jt));{var _a=o=>{var l=ee();st("click",l,()=>{x(R,!0)}),v(o,l)};j(ua,o=>{!t(R)&&!t(O)&&o(_a)})}a(jt);var zt=r(jt,2);{var ca=o=>{var l=re(),p=e(l);Sa(p);var c=r(p,2),s=r(c,2),h=r(s,2);{var b=_=>{var C=se(),m=e(C,!0);a(C),T(()=>d(m,t(V))),v(_,C)};j(h,_=>{t(V)&&_(b)})}a(l),T(()=>{p.disabled=t(B),c.disabled=t(B),s.disabled=t(B)}),st("keydown",p,_=>{_.key==="Enter"&&Dt(),_.key==="Escape"&&vt()}),Ca(p,()=>t(W),_=>x(W,_)),st("click",c,Dt),st("click",s,vt),v(o,l)};j(zt,o=>{t(R)&&o(ca)})}var Gt=r(zt,2);{var pa=o=>{var l=ne(),p=e(l),c=r(e(p),2),s=e(c,!0);a(c);var h=r(c,2),b=e(h,!0);a(h);var _=r(h,2);a(p);var C=r(p,4),m=e(C),k=e(m,!0);a(m);var A=r(m,2),w=e(A,!0);a(A),a(C),a(l),T(U=>{d(s,t(O).name),d(b,t(O).token),d(k,t(X)?"[copied]":"[copy]"),d(w,U)},[()=>Et(t(O).token)]),st("click",_,()=>{x(O,null),x(X,!1)}),st("click",m,Wt),v(o,l)};j(Gt,o=>{t(O)&&o(pa)})}var Jt=r(Gt,2);{var ma=o=>{var l=oe();v(o,l)},ha=o=>{var l=ve(),p=r(e(l));it(p,21,()=>t(f).users,c=>c.id,(c,s)=>{var h=le(),b=e(h),_=e(b),C=e(_,!0);a(_),a(b);var m=r(b),k=e(m),A=e(k,!0);a(k),a(m);var w=r(m),U=e(w,!0);a(w);var z=r(w),G=e(z,!0);a(z),a(h),T((J,q,Z)=>{ut(_,"href",`${_t??""}/users/${t(s).id??""}`),d(C,t(s).name),P(k,1,J,"svelte-x1i5gj"),d(A,t(s).status),d(U,q),P(z,1,`num ${t(s).total_cost===0?"muted":""}`),d(G,Z)},[()=>L(Ot(t(s).status)),()=>qt(t(s).last_active_at??""),()=>Ut(t(s).total_cost)]),v(c,h)}),a(p),a(l),v(o,l)};j(Jt,o=>{t(f).users.length===0?o(ma):o(ha,!1)})}var fa=r(Jt,4);{var ba=o=>{var l=de();v(o,l)},xa=o=>{var l=ue();it(l,21,()=>t(f).events,p=>p.ts,(p,c)=>{var s=ie(),h=e(s),b=e(h,!0);a(h);var _=r(h,2),C=e(_,!0);a(_);var m=r(_);a(s),T((k,A,w)=>{d(b,k),P(_,1,A,"svelte-x1i5gj"),d(C,w),d(m,` ${t(c).message??""}`)},[()=>ct(t(c).ts),()=>L(Ta(t(c).type)),()=>t(c).type.toUpperCase()]),v(p,s)}),a(l),v(o,l)};j(fa,o=>{t(f).events.length===0?o(ba):o(xa,!1)})}T(()=>{d(aa,t(ot)),d(Rt,`${t(f).health.version??""} · up ${t(f).health.uptime??""} · sqlite `),P(yt,1,L(t(f).health.sqlite==="ok"?"g":"r")),d(ea,t(f).health.sqlite),ut(na,"href",`${_t??""}/add-account`),ut(va,"href",`${_t??""}/add-account`)}),st("click",Mt,lt),v(g,It)};j(Xt,g=>{t(N)?g(Zt):t(f)?g(ta,!1):g($t,1)})}v(bt,Nt),Vt()}ja(["click","keydown"]);export{we as component,ke as universal};
