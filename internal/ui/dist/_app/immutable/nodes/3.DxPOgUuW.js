import{a as v,f as u,c as Qt}from"../chunks/YPNk2NX5.js";import{b as It,s as I,w as Ga,n as i,ad as Ha,j as o,k as s,m as g,g as t,d as Mt,ac as F,ab as Xt,f as A,e as n,aa as Fa,as as qa}from"../chunks/ABNvuIHC.js";import{s as l,d as Yt,a as z}from"../chunks/e87nZPu-.js";import{i as w}from"../chunks/CCxA75cu.js";import{s as rt,c as lt,i as Ka,f as Qa,a as Et,e as Vt}from"../chunks/cNbZ-Ql0.js";import{r as Zt,s as Ot}from"../chunks/ct8flr_T.js";import{a as $t}from"../chunks/2sA3hMLD.js";import{s as Va,a as Wa}from"../chunks/BJOaqqeD.js";import{p as Xa}from"../chunks/5NzNco59.js";import{g as Ya}from"../chunks/DP1SWo-P.js";import{b as Dt}from"../chunks/DmuWyb2n.js";import{a as U}from"../chunks/DtH33QRI.js";import{C as Wt}from"../chunks/EPbnI6Jf.js";const Za=!1,Ye=Object.freeze(Object.defineProperty({__proto__:null,ssr:Za},Symbol.toStringTag,{value:"Module"}));var $a=u("<span> </span>");function te(X,S){It(S,!0);let q=I(Ga(Date.now()));const J=setInterval(()=>{i(q,Date.now(),!0)},1e3);Ha(()=>clearInterval(J));let L=F(()=>S.expiresAt-t(q)),a=F(()=>t(L)<=0),B=F(()=>{if(t(a))return"expired";const b=Math.floor(t(L)/1e3),Q=Math.floor(b/3600),V=Math.floor(b%3600/60),Y=b%60;return`${Q}h ${String(V).padStart(2,"0")}m ${String(Y).padStart(2,"0")}s`}),K=F(()=>{if(t(a))return"r";const b=Math.floor(t(L)/6e4);return b<10?"r":b<60?"o":"g"});var E=$a(),R=o(E,!0);s(E),g(()=>{rt(E,1,lt(t(K))),l(R,t(B))}),v(X,E),Mt()}var ae=u('<span class="g">auto</span> <span class="muted"> </span> <button class="link" style="font-size:12px;margin-left:6px">[switch to manual]</button>',1),ee=u('<input class="pri-edit svelte-1uolqt3" type="text"/> <button class="link" style="font-size:12px"> </button> <button class="link" style="font-size:12px;margin-left:6px">[switch to auto]</button>',1),re=u('<span class="error-msg"> </span>'),se=u("<!> <!>",1);function oe(X,S){It(S,!0);let q=F(()=>S.priorityMode==="auto"),J=I(""),L=I(!1),a=I("");Xt(()=>{i(J,String(S.priority),!0)});async function B(){const k=parseInt(t(J));if(!isNaN(k)){i(L,!0),i(a,"");try{await U(`/accounts/${S.accountId}/priority`,{method:"POST",body:JSON.stringify({mode:"manual",priority:k})}),S.onupdate("manual",k)}catch(M){i(a,M.message,!0)}finally{i(L,!1)}}}async function K(){i(a,"");try{await U(`/accounts/${S.accountId}/priority`,{method:"POST",body:JSON.stringify({mode:"auto"})}),S.onupdate("auto",S.priority)}catch(k){i(a,k.message,!0)}}async function E(){i(a,"");try{await U(`/accounts/${S.accountId}/priority`,{method:"POST",body:JSON.stringify({mode:"manual",priority:S.priority})}),S.onupdate("manual",S.priority)}catch(k){i(a,k.message,!0)}}var R=se(),b=A(R);{var Q=k=>{var M=ae(),P=n(A(M),2),j=o(P);s(P);var Z=n(P,2);g(()=>l(j,`(score: ${S.autoScore??""})`)),z("click",Z,E),v(k,M)},V=k=>{var M=ee(),P=A(M);Zt(P);var j=n(P,2),Z=o(j,!0);s(j);var ut=n(j,2);g(()=>{j.disabled=t(L),l(Z,t(L)?"saving...":"[save]")}),z("keydown",P,C=>{C.key==="Enter"&&B()}),$t(P,()=>t(J),C=>i(J,C)),z("click",j,B),z("click",ut,K),v(k,M)};w(b,k=>{t(q)?k(Q):k(V,!1)})}var Y=n(b,2);{var vt=k=>{var M=re(),P=o(M,!0);s(M),g(()=>l(P,t(a))),v(k,M)};w(Y,k=>{t(a)&&k(vt)})}v(X,R),Mt()}Yt(["click","keydown"]);var ne=u('<p class="error-msg"> </p> <p><a>&larr; back to dashboard</a></p>',1),de=u('<p class="loading">loading account...</p>'),ie=u('<p class="error-msg"> </p>'),le=u('<span class="g">&#10003; ok</span> <span class="muted"> </span>',1),ve=u('<span class="r">&#10007; failed</span> <span class="muted"> </span>',1),ue=u('<div class="bar" style="margin-top:0"><!></div>'),ce=u('<input type="text" style="width:240px;font:13px monospace;border:1px solid #ccc;padding:0 4px;"/> <button class="link" style="font-size:12px"> </button> <button class="link" style="font-size:12px;margin-left:4px">[cancel]</button>',1),_e=u(' <button class="link" style="font-size:12px;margin-left:6px">[edit]</button>',1),fe=u('<span class="error-msg"> </span>'),pe=u(' <span class="muted"> </span>',1),me=u(' <span class="muted"> </span>',1),ge=u('<span class="muted">-</span>'),he=u(' <span class="muted"> </span>',1),ye=u('<span class="muted">-</span>'),xe=u('<span class="o"> </span>'),be=u('<span class="muted">-</span>'),ke=u('<span class="o"> </span>'),we=u('<span class="muted">-</span>'),Se=u('<dt>5h window</dt> <dd><span> </span></dd> <dt>5h remain</dt> <dd><span class="muted">-</span></dd> <dt>7d remain</dt> <dd><span class="muted">-</span></dd> <dt>opus rate limit</dt> <dd><!></dd>',1),Te=u('<dt>primary remain</dt> <dd><span class="muted">-</span></dd> <dt>secondary remain</dt> <dd><span class="muted">-</span></dd>',1),Ae=u(' <span class="muted"> </span>',1),Ee=u('<span class="muted">-</span>'),Oe=u('<span class="r"> </span>'),De=u('<span class="muted">-</span>'),Ie=u("<dt> </dt> <dd> </dd>",1),Me=u("<dl></dl>"),Pe=u('<p class="muted">not captured yet</p>'),ze=u("<h2>stainless fingerprint</h2> <!>",1),Le=u('<p class="muted">no active session bindings</p>'),Ne=u('<tr><td class="muted"> </td><td> </td><td> </td><td><!></td></tr>'),Ue=u("<table><thead><tr><th>session uuid</th><th>last active</th><th>ttl</th><th></th></tr></thead><tbody></tbody></table>"),Re=u('<h2> <span class="muted"> </span></h2> <div class="actions"><button class="link"> </button> <button class="link">[refresh token]</button> <button> </button> <!></div> <!> <!> <h2>info</h2> <dl><dt>id</dt> <dd class="muted"> </dd> <dt>status</dt> <dd><span> </span></dd> <dt>email</dt> <dd><!> <!></dd> <dt>org</dt> <dd><!></dd> <dt>priority</dt> <dd><!></dd> <dt>created</dt> <dd> </dd></dl> <h2>token</h2> <dl><dt>expires in</dt> <dd><!></dd> <dt>last refreshed</dt> <dd><!></dd></dl> <h2>scheduling</h2> <dl><dt>schedulable</dt> <dd> </dd> <dt>cooldown</dt> <dd><!></dd> <!> <dt>last used</dt> <dd><!></dd> <dt>error</dt> <dd><!></dd></dl> <!> <h2>bound sessions <span class="muted"> </span></h2> <!> <p style="margin-top:16px;font-size:12px"><a>&larr; back</a></p>',1);function Ze(X,S){It(S,!0);const q=()=>Va(Xa,"$page",J),[J,L]=Wa();let a=I(null),B=I(""),K=I(!0),E=I(null),R=I(!1),b=I("");Xt(()=>{Q()});async function Q(){try{i(a,await U("/accounts/"+q().params.id),!0)}catch(d){i(B,d.message,!0)}finally{i(K,!1)}}function V(d){if(!d)return"-";const m=new Date(d).getTime()-Date.now();if(m<=0)return"passed";const O=Math.floor(m/1e3),N=Math.floor(O/60),G=O%60;return N<60?`${N}m ${String(G).padStart(2,"0")}s`:`${Math.floor(N/60)}h ${N%60}m ${String(G).padStart(2,"0")}s`}function Y(d){if(!d)return"-";const m=new Date(d).getTime()-Date.now();if(m<=0)return"expired";const O=Math.floor(m/6e4);return O<60?`${O}m`:`${Math.floor(O/60)}h ${O%60}m`}function vt(d){return d==="allowed"?"g":d==="stopped"||d==="warning"?"o":"r"}async function k(){if(t(a)){i(R,!0),i(E,null);try{const d=await U(`/accounts/${t(a).id}/test`,{method:"POST"});i(E,{...d,time:new Date().toLocaleTimeString("en-GB",{hour12:!1})},!0)}catch(d){i(E,{ok:!1,latency_ms:0,error:d.message,time:new Date().toLocaleTimeString("en-GB",{hour12:!1})},!0)}finally{i(R,!1)}}}async function M(){if(t(a)){i(b,"");try{await U(`/accounts/${t(a).id}/refresh`,{method:"POST"}),await Q()}catch(d){i(b,d.message,!0)}}}async function P(){if(!t(a))return;const d=t(a).status==="disabled"?"active":"disabled";i(b,"");try{await U(`/accounts/${t(a).id}/status`,{method:"POST",body:JSON.stringify({status:d})}),t(a).status=d}catch(m){i(b,m.message,!0)}}async function j(){if(t(a)){i(b,"");try{await U(`/accounts/${t(a).id}`,{method:"DELETE"}),Ya(`${Dt}/dashboard`)}catch(d){i(b,d.message,!0)}}}async function Z(d){if(t(a)){i(b,"");try{await U(`/sessions/binding/${d}`,{method:"DELETE"}),t(a).sessions=t(a).sessions.filter(m=>m.session_uuid!==d)}catch(m){i(b,m.message,!0)}}}function ut(d,m){t(a)&&(t(a).priority_mode=d,t(a).priority=m)}let C=I(!1),st=I(""),ot=I(!1),H=I("");async function Pt(){if(!t(a))return;const d=t(st).trim();if(d){i(ot,!0),i(H,"");try{const m=await U(`/accounts/${t(a).id}/email`,{method:"POST",body:JSON.stringify({email:d})});t(a).email=m.email,i(C,!1)}catch(m){i(H,m.message,!0)}finally{i(ot,!1)}}}var zt=Qt(),ta=A(zt);{var aa=d=>{var m=ne(),O=A(m),N=o(O,!0);s(O);var G=n(O,2),nt=o(G);s(G),g(()=>{l(N,t(B)),Ot(nt,"href",`${Dt??""}/dashboard`)}),v(d,m)},ea=d=>{var m=de();v(d,m)},ra=d=>{var m=Re(),O=A(m),N=o(O),G=n(N),nt=o(G,!0);s(G),s(O);var ct=n(O,2),$=o(ct),sa=o($,!0);s($);var Lt=n($,2),tt=n(Lt,2),oa=o(tt);s(tt);var na=n(tt,2);Wt(na,{label:"[delete]",cls:"r",onclick:j}),s(ct);var Nt=n(ct,2);{var da=e=>{var r=ie(),c=o(r,!0);s(r),g(()=>l(c,t(b))),v(e,r)};w(Nt,e=>{t(b)&&e(da)})}var Ut=n(Nt,2);{var ia=e=>{var r=ue(),c=o(r);{var f=p=>{var _=le(),h=n(A(_)),y=n(h),x=o(y,!0);s(y),g(D=>{l(h,` — ${t(a).provider==="codex"?"codex":"haiku"} — ${D??""}s — `),l(x,t(E).time)},[()=>(t(E).latency_ms/1e3).toFixed(1)]),v(p,_)},T=p=>{var _=ve(),h=n(A(_)),y=n(h),x=o(y,!0);s(y),g(()=>{l(h,` — ${t(E).error??""} — `),l(x,t(E).time)}),v(p,_)};w(c,p=>{t(E).ok?p(f):p(T,!1)})}s(r),v(e,r)};w(Ut,e=>{t(E)&&e(ia)})}var _t=n(Ut,4),ft=n(o(_t),2),la=o(ft,!0);s(ft);var pt=n(ft,4),mt=o(pt),va=o(mt,!0);s(mt),s(pt);var gt=n(pt,4),Rt=o(gt);{var ua=e=>{var r=ce(),c=A(r);Zt(c),Ot(c,"maxlength",100);var f=n(c,2),T=o(f,!0);s(f);var p=n(f,2);g(()=>{f.disabled=t(ot),l(T,t(ot)?"saving...":"[save]")}),z("keydown",c,_=>{_.key==="Enter"&&Pt(),_.key==="Escape"&&(i(C,!1),i(H,""))}),$t(c,()=>t(st),_=>i(st,_)),z("click",f,Pt),z("click",p,()=>{i(C,!1),i(H,"")}),v(e,r)},ca=e=>{var r=_e(),c=A(r),f=n(c);g(()=>l(c,`${t(a).email??""} `)),z("click",f,()=>{i(st,t(a).email,!0),i(C,!0),i(H,"")}),v(e,r)};w(Rt,e=>{t(C)?e(ua):e(ca,!1)})}var _a=n(Rt,2);{var fa=e=>{var r=fe(),c=o(r,!0);s(r),g(()=>l(c,t(H))),v(e,r)};w(_a,e=>{t(H)&&e(fa)})}s(gt);var ht=n(gt,4),pa=o(ht);{var ma=e=>{var r=Qt(),c=A(r);{var f=p=>{var _=pe(),h=A(_),y=n(h),x=o(y);s(y),g(()=>{l(h,`${(t(a).extInfo.orgTitle||"-")??""} `),l(x,`(account: ${(t(a).extInfo.chatgptAccountId||"-")??""})`)}),v(p,_)},T=p=>{var _=me(),h=A(_),y=n(h),x=o(y);s(y),g(()=>{l(h,`${t(a).extInfo.orgName??""} `),l(x,`(uuid: ${t(a).extInfo.orgUUID??""})`)}),v(p,_)};w(c,p=>{t(a).provider==="codex"?p(f):p(T,!1)})}v(e,r)},ga=e=>{var r=ge();v(e,r)};w(pa,e=>{t(a).extInfo?e(ma):e(ga,!1)})}s(ht);var yt=n(ht,4),ha=o(yt);oe(ha,{get accountId(){return t(a).id},get priority(){return t(a).priority},get priorityMode(){return t(a).priority_mode},get autoScore(){return t(a).auto_score},onupdate:ut}),s(yt);var jt=n(yt,4),ya=o(jt,!0);s(jt),s(_t);var xt=n(_t,4),bt=n(o(xt),2),xa=o(bt);te(xa,{get expiresAt(){return t(a).expiresAt}}),s(bt);var Ct=n(bt,4),ba=o(Ct);{var ka=e=>{var r=he(),c=A(r),f=n(c),T=o(f);s(f),g((p,_)=>{l(c,`${p??""} `),l(T,`(${_??""})`)},[()=>Et(t(a).lastRefreshAt),()=>new Date(t(a).lastRefreshAt).toLocaleTimeString("en-GB",{hour12:!1})]),v(e,r)},wa=e=>{var r=ye();v(e,r)};w(ba,e=>{t(a).lastRefreshAt?e(ka):e(wa,!1)})}s(Ct),s(xt);var kt=n(xt,4),dt=n(o(kt),2),Sa=o(dt,!0);s(dt);var wt=n(dt,4),Ta=o(wt);{var Aa=e=>{var r=xe(),c=o(r,!0);s(r),g(f=>l(c,f),[()=>V(t(a).overloadedUntil)]),v(e,r)},Ea=e=>{var r=be();v(e,r)};w(Ta,e=>{t(a).overloadedUntil?e(Aa):e(Ea,!1)})}s(wt);var Jt=n(wt,2);{var Oa=e=>{var r=Se(),c=n(A(r),2),f=o(c),T=o(f,!0);s(f),s(c);var p=n(c,12),_=o(p);{var h=x=>{var D=ke(),at=o(D,!0);s(D),g(W=>l(at,W),[()=>V(t(a).opusRateLimitEndAt)]),v(x,D)},y=x=>{var D=we();v(x,D)};w(_,x=>{t(a).opusRateLimitEndAt?x(h):x(y,!1)})}s(p),g(x=>{rt(f,1,x),l(T,t(a).fiveHourStatus||"-")},[()=>lt(vt(t(a).fiveHourStatus))]),v(e,r)},Da=e=>{var r=Te();Fa(6),v(e,r)};w(Jt,e=>{t(a).provider!=="codex"?e(Oa):e(Da,!1)})}var St=n(Jt,4),Ia=o(St);{var Ma=e=>{var r=Ae(),c=A(r),f=n(c),T=o(f);s(f),g((p,_)=>{l(c,`${p??""} `),l(T,`(${_??""})`)},[()=>Et(t(a).lastUsedAt),()=>new Date(t(a).lastUsedAt).toLocaleTimeString("en-GB",{hour12:!1})]),v(e,r)},Pa=e=>{var r=Ee();v(e,r)};w(Ia,e=>{t(a).lastUsedAt?e(Ma):e(Pa,!1)})}s(St);var Bt=n(St,4),za=o(Bt);{var La=e=>{var r=Oe(),c=o(r,!0);s(r),g(()=>l(c,t(a).errorMessage)),v(e,r)},Na=e=>{var r=De();v(e,r)};w(za,e=>{t(a).errorMessage?e(La):e(Na,!1)})}s(Bt),s(kt);var Gt=n(kt,2);{var Ua=e=>{var r=ze(),c=n(A(r),2);{var f=_=>{var h=Me();Vt(h,21,()=>Object.entries(t(a).stainless),([y,x])=>y,(y,x)=>{var D=F(()=>qa(t(x),2));let at=()=>t(D)[0],W=()=>t(D)[1];var it=Ie(),et=A(it),At=o(et,!0);s(et);var Kt=n(et,2),Ba=o(Kt,!0);s(Kt),g(()=>{l(At,at()),l(Ba,W())}),v(y,it)}),s(h),v(_,h)},T=F(()=>t(a).stainless&&Object.keys(t(a).stainless).length>0),p=_=>{var h=Pe();v(_,h)};w(c,_=>{t(T)?_(f):_(p,!1)})}v(e,r)};w(Gt,e=>{t(a).provider!=="codex"&&e(Ua)})}var Tt=n(Gt,2),Ht=n(o(Tt)),Ra=o(Ht);s(Ht),s(Tt);var Ft=n(Tt,2);{var ja=e=>{var r=Le();v(e,r)},Ca=e=>{var r=Ue(),c=n(o(r));Vt(c,21,()=>t(a).sessions,f=>f.session_uuid,(f,T)=>{var p=Ne(),_=o(p),h=o(_,!0);s(_);var y=n(_),x=o(y,!0);s(y);var D=n(y),at=o(D,!0);s(D);var W=n(D),it=o(W);Wt(it,{label:"unbind",onclick:()=>Z(t(T).session_uuid)}),s(W),s(p),g((et,At)=>{l(h,t(T).session_uuid),l(x,et),l(at,At)},[()=>Et(t(T).last_used_at),()=>Y(t(T).expires_at)]),v(f,p)}),s(c),s(r),v(e,r)};w(Ft,e=>{t(a).sessions.length===0?e(ja):e(Ca,!1)})}var qt=n(Ft,2),Ja=o(qt);s(qt),g((e,r)=>{l(N,`${t(a).email??""} `),l(nt,t(a).provider),$.disabled=t(R),l(sa,t(R)?"[testing...]":"[test]"),rt(tt,1,`link ${t(a).status==="disabled"?"g":"r"}`),l(oa,`[${t(a).status==="disabled"?"enable":"disable"}]`),l(la,t(a).id),rt(mt,1,e),l(va,t(a).status),l(ya,r),rt(dt,1,lt(t(a).schedulable?"g":"r")),l(Sa,t(a).schedulable?"yes":"no"),l(Ra,`(${t(a).sessions.length??""})`),Ot(Ja,"href",`${Dt??""}/dashboard`)},[()=>lt(Ka(t(a).status)),()=>Qa(t(a).createdAt)]),z("click",$,k),z("click",Lt,M),z("click",tt,P),v(d,m)};w(ta,d=>{t(B)?d(aa):t(K)?d(ea,1):t(a)&&d(ra,2)})}v(X,zt),Mt(),L()}Yt(["click","keydown"]);export{Ze as component,Ye as universal};
