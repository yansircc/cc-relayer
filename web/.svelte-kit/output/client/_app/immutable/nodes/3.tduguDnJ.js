import{a as u,f as c,c as Va,t as Ft}from"../chunks/Cefu_kJh.js";import{a as Dt,s as S,o as Wa,k as d,ac as Xa,e as o,i as s,j as m,g as t,b as Ot,ab as J,aa as Qt,f as O,d as n,ar as Ya}from"../chunks/xTExy2GW.js";import{s as v,d as Vt,a as M}from"../chunks/C8R120ip.js";import{i as b}from"../chunks/Bbanrw_8.js";import{s as $,c as rt,t as Za,f as $a,a as Tt,e as qt}from"../chunks/NSlhNWv0.js";import{r as Wt,s as At}from"../chunks/Buwlz4xJ.js";import{b as Xt}from"../chunks/CKMoCsps.js";import{s as te,a as ae}from"../chunks/C__oTgmm.js";import{p as ee}from"../chunks/B_x2WSxB.js";import{g as re}from"../chunks/Ov88F790.js";import{b as Et}from"../chunks/BaD-Jc5Z.js";import{a as z}from"../chunks/DtH33QRI.js";import{C as Kt}from"../chunks/MCzZf4ba.js";const se=!1,$e=Object.freeze(Object.defineProperty({__proto__:null,ssr:se},Symbol.toStringTag,{value:"Module"}));var oe=c("<span> </span>");function ne(W,h){Dt(h,!0);let H=S(Wa(Date.now()));const R=setInterval(()=>{d(H,Date.now(),!0)},1e3);Xa(()=>clearInterval(R));let I=J(()=>h.expiresAt-t(H)),e=J(()=>t(I)<=0),j=J(()=>{if(t(e))return"expired";const g=Math.floor(t(I)/1e3),q=Math.floor(g/60),K=g%60;return`${q}m ${String(K).padStart(2,"0")}s remaining`}),F=J(()=>{if(t(e))return"r";const g=Math.floor(t(I)/6e4);return g<10?"r":g<60?"o":"g"});var x=oe(),L=o(x,!0);s(x),m(()=>{$(x,1,rt(t(F))),v(L,t(j))}),u(W,x),Ot()}var ie=c('<span class="g">auto</span> <span class="muted"> </span> <button class="link" style="font-size:12px;margin-left:6px">[switch to manual]</button>',1),de=c('<input class="pri-edit svelte-1uolqt3" type="text"/> <button class="link" style="font-size:12px"> </button> <button class="link" style="font-size:12px;margin-left:6px">[switch to auto]</button>',1),le=c('<span class="error-msg"> </span>'),ue=c("<!> <!>",1);function ve(W,h){Dt(h,!0);let H=J(()=>h.priorityMode==="auto"),R=S(""),I=S(!1),e=S("");Qt(()=>{d(R,String(h.priority),!0)});async function j(){const p=parseInt(t(R));if(!isNaN(p)){d(I,!0),d(e,"");try{await z(`/accounts/${h.accountId}/priority`,{method:"POST",body:JSON.stringify({mode:"manual",priority:p})}),h.onupdate("manual",p)}catch(T){d(e,T.message,!0)}finally{d(I,!1)}}}async function F(){d(e,"");try{await z(`/accounts/${h.accountId}/priority`,{method:"POST",body:JSON.stringify({mode:"auto"})}),h.onupdate("auto",h.priority)}catch(p){d(e,p.message,!0)}}async function x(){d(e,"");try{await z(`/accounts/${h.accountId}/priority`,{method:"POST",body:JSON.stringify({mode:"manual",priority:h.priority})}),h.onupdate("manual",h.priority)}catch(p){d(e,p.message,!0)}}var L=ue(),g=O(L);{var q=p=>{var T=ie(),D=n(O(T),2),N=o(D);s(D);var X=n(D,2);m(()=>v(N,`(score: ${h.autoScore??""})`)),M("click",X,x),u(p,T)},K=p=>{var T=de(),D=O(T);Wt(D);var N=n(D,2),X=o(N,!0);s(N);var nt=n(N,2);m(()=>{N.disabled=t(I),v(X,t(I)?"saving...":"[save]")}),M("keydown",D,U=>{U.key==="Enter"&&j()}),Xt(D,()=>t(R),U=>d(R,U)),M("click",N,j),M("click",nt,F),u(p,T)};b(g,p=>{t(H)?p(q):p(K,!1)})}var st=n(g,2);{var ot=p=>{var T=le(),D=o(T,!0);s(T),m(()=>v(D,t(e))),u(p,T)};b(st,p=>{t(e)&&p(ot)})}u(W,L),Ot()}Vt(["click","keydown"]);var ce=c('<p class="error-msg"> </p> <p><a>&larr; back to dashboard</a></p>',1),fe=c('<p class="loading">loading account...</p>'),_e=c('<p class="error-msg"> </p>'),pe=c('<span class="g">&#10003; ok</span> <span class="muted"> </span>',1),me=c('<span class="r">&#10007; failed</span> <span class="muted"> </span>',1),ge=c('<div class="bar" style="margin-top:0"><!></div>'),he=c('<input type="text" style="width:240px;font:13px monospace;border:1px solid #ccc;padding:0 4px;"/> <button class="link" style="font-size:12px"> </button> <button class="link" style="font-size:12px;margin-left:4px">[cancel]</button>',1),ye=c(' <button class="link" style="font-size:12px;margin-left:6px">[edit]</button>',1),be=c('<span class="error-msg"> </span>'),xe=c(' <span class="muted"> </span>',1),ke=c('<span class="muted">-</span>'),we=c('<span class="muted">-</span>'),Se=c('<span class="g">ok</span>'),Te=c('<span class="r">expired</span>'),Ae=c('<span class="o"> </span>'),Ee=c('<span class="muted">-</span>'),De=c('<span class="o"> </span>'),Oe=c('<span class="muted">-</span>'),Me=c('<span class="muted">-</span>'),Ie=c('<span class="r"> </span>'),Pe=c('<span class="muted">-</span>'),ze=c("<dt> </dt> <dd> </dd>",1),Le=c("<dl></dl>"),Ne=c('<p class="muted">not captured yet</p>'),Ue=c('<p class="muted">no active session bindings</p>'),Re=c('<tr><td class="muted"> </td><td> </td><td> </td><td><!></td></tr>'),je=c("<table><thead><tr><th>session uuid</th><th>last active</th><th>ttl</th><th></th></tr></thead><tbody></tbody></table>"),Ce=c('<h2> <span> </span></h2> <div class="actions"><button class="link"> </button> <button class="link">[force refresh token]</button> <button> </button> <!></div> <!> <!> <h2>info</h2> <dl><dt>id</dt> <dd class="muted"> </dd> <dt>email</dt> <dd><!> <!></dd> <dt>org</dt> <dd><!></dd> <dt>priority</dt> <dd><!></dd> <dt>created</dt> <dd> </dd></dl> <h2>token</h2> <dl><dt>access token expires</dt> <dd><!></dd> <dt>last refreshed</dt> <dd><!></dd> <dt>refresh status</dt> <dd><!></dd></dl> <h2>scheduling</h2> <dl><dt>schedulable</dt> <dd> </dd> <dt>overloaded until</dt> <dd><!></dd> <dt>5h window</dt> <dd><span> </span></dd> <dt>opus rate limit</dt> <dd><!></dd> <dt>last used</dt> <dd><!></dd> <dt>error message</dt> <dd><!></dd></dl> <h2>stainless fingerprint</h2> <!> <h2>bound sessions <span class="muted"> </span></h2> <!> <p style="margin-top:16px;font-size:12px"><a>&larr; back</a></p>',1);function tr(W,h){Dt(h,!0);const H=()=>te(ee,"$page",R),[R,I]=ae();let e=S(null),j=S(""),F=S(!0),x=S(null),L=S(!1),g=S("");Qt(()=>{q()});async function q(){try{d(e,await z("/accounts/"+H().params.id),!0)}catch(i){d(j,i.message,!0)}finally{d(F,!1)}}function K(i){if(!i)return"-";const _=new Date(i).getTime()-Date.now();if(_<=0)return"passed";const y=Math.floor(_/6e4);return y<60?`${y}m`:`${Math.floor(y/60)}h ${y%60}m`}function st(i){if(!i)return"-";const _=new Date(i).getTime()-Date.now();if(_<=0)return"expired";const y=Math.floor(_/6e4);return y<60?`${y}m`:`${Math.floor(y/60)}h ${y%60}m`}function ot(i){return i==="allowed"?"g":i==="stopped"||i==="warning"?"o":"r"}async function p(){if(t(e)){d(L,!0),d(x,null);try{const i=await z(`/accounts/${t(e).id}/test`,{method:"POST"});d(x,{...i,time:new Date().toLocaleTimeString("en-GB",{hour12:!1})},!0)}catch(i){d(x,{ok:!1,latency_ms:0,error:i.message,time:new Date().toLocaleTimeString("en-GB",{hour12:!1})},!0)}finally{d(L,!1)}}}async function T(){if(t(e)){d(g,"");try{await z(`/accounts/${t(e).id}/refresh`,{method:"POST"}),await q()}catch(i){d(g,i.message,!0)}}}async function D(){if(!t(e))return;const i=t(e).status==="disabled"?"active":"disabled";d(g,"");try{await z(`/accounts/${t(e).id}/status`,{method:"POST",body:JSON.stringify({status:i})}),t(e).status=i}catch(_){d(g,_.message,!0)}}async function N(){if(t(e)){d(g,"");try{await z(`/accounts/${t(e).id}`,{method:"DELETE"}),re(`${Et}/dashboard`)}catch(i){d(g,i.message,!0)}}}async function X(i){if(t(e)){d(g,"");try{await z(`/sessions/binding/${i}`,{method:"DELETE"}),t(e).sessions=t(e).sessions.filter(_=>_.session_uuid!==i)}catch(_){d(g,_.message,!0)}}}function nt(i,_){t(e)&&(t(e).priority_mode=i,t(e).priority=_)}let U=S(!1),tt=S(""),at=S(!1),B=S("");async function Mt(){if(!t(e))return;const i=t(tt).trim();if(i){d(at,!0),d(B,"");try{const _=await z(`/accounts/${t(e).id}/email`,{method:"POST",body:JSON.stringify({email:i})});t(e).email=_.email,d(U,!1)}catch(_){d(B,_.message,!0)}finally{d(at,!1)}}}var It=Va(),Yt=O(It);{var Zt=i=>{var _=ce(),y=O(_),Q=o(y,!0);s(y);var V=n(y,2),it=o(V);s(V),m(()=>{v(Q,t(j)),At(it,"href",`${Et??""}/dashboard`)}),u(i,_)},$t=i=>{var _=fe();u(i,_)},ta=i=>{var _=Ce(),y=O(_),Q=o(y),V=n(Q),it=o(V,!0);s(V),s(y);var dt=n(y,2),Y=o(dt),aa=o(Y,!0);s(Y);var Pt=n(Y,2),Z=n(Pt,2),ea=o(Z);s(Z);var ra=n(Z,2);Kt(ra,{label:"[delete]",cls:"r",onclick:N}),s(dt);var zt=n(dt,2);{var sa=a=>{var r=_e(),l=o(r,!0);s(r),m(()=>v(l,t(g))),u(a,r)};b(zt,a=>{t(g)&&a(sa)})}var Lt=n(zt,2);{var oa=a=>{var r=ge(),l=o(r);{var f=w=>{var k=pe(),P=n(O(k)),E=n(P),G=o(E,!0);s(E),m(C=>{v(P,` — haiku — ${C??""}s — `),v(G,t(x).time)},[()=>(t(x).latency_ms/1e3).toFixed(1)]),u(w,k)},A=w=>{var k=me(),P=n(O(k)),E=n(P),G=o(E,!0);s(E),m(()=>{v(P,` — ${t(x).error??""} — `),v(G,t(x).time)}),u(w,k)};b(l,w=>{t(x).ok?w(f):w(A,!1)})}s(r),u(a,r)};b(Lt,a=>{t(x)&&a(oa)})}var lt=n(Lt,4),ut=n(o(lt),2),na=o(ut,!0);s(ut);var vt=n(ut,4),Nt=o(vt);{var ia=a=>{var r=he(),l=O(r);Wt(l),At(l,"maxlength",100);var f=n(l,2),A=o(f,!0);s(f);var w=n(f,2);m(()=>{f.disabled=t(at),v(A,t(at)?"saving...":"[save]")}),M("keydown",l,k=>{k.key==="Enter"&&Mt(),k.key==="Escape"&&(d(U,!1),d(B,""))}),Xt(l,()=>t(tt),k=>d(tt,k)),M("click",f,Mt),M("click",w,()=>{d(U,!1),d(B,"")}),u(a,r)},da=a=>{var r=ye(),l=O(r),f=n(l);m(()=>v(l,`${t(e).email??""} `)),M("click",f,()=>{d(tt,t(e).email,!0),d(U,!0),d(B,"")}),u(a,r)};b(Nt,a=>{t(U)?a(ia):a(da,!1)})}var la=n(Nt,2);{var ua=a=>{var r=be(),l=o(r,!0);s(r),m(()=>v(l,t(B))),u(a,r)};b(la,a=>{t(B)&&a(ua)})}s(vt);var ct=n(vt,4),va=o(ct);{var ca=a=>{var r=xe(),l=O(r),f=n(l),A=o(f);s(f),m(()=>{v(l,`${t(e).extInfo.orgName??""} `),v(A,`(uuid: ${t(e).extInfo.orgUUID??""})`)}),u(a,r)},fa=a=>{var r=ke();u(a,r)};b(va,a=>{t(e).extInfo?a(ca):a(fa,!1)})}s(ct);var ft=n(ct,4),_a=o(ft);ve(_a,{get accountId(){return t(e).id},get priority(){return t(e).priority},get priorityMode(){return t(e).priority_mode},get autoScore(){return t(e).auto_score},onupdate:nt}),s(ft);var Ut=n(ft,4),pa=o(Ut,!0);s(Ut),s(lt);var _t=n(lt,4),pt=n(o(_t),2),ma=o(pt);ne(ma,{get expiresAt(){return t(e).expiresAt}}),s(pt);var mt=n(pt,4),ga=o(mt);{var ha=a=>{var r=Ft();m((l,f)=>v(r,`${l??""} (${f??""})`),[()=>Tt(t(e).lastRefreshAt),()=>new Date(t(e).lastRefreshAt).toLocaleTimeString("en-GB",{hour12:!1})]),u(a,r)},ya=a=>{var r=we();u(a,r)};b(ga,a=>{t(e).lastRefreshAt?a(ha):a(ya,!1)})}s(mt);var Rt=n(mt,4),ba=o(Rt);{var xa=a=>{var r=Se();u(a,r)},ka=J(()=>t(e).expiresAt>Date.now()),wa=a=>{var r=Te();u(a,r)};b(ba,a=>{t(ka)?a(xa):a(wa,!1)})}s(Rt),s(_t);var gt=n(_t,4),et=n(o(gt),2),Sa=o(et,!0);s(et);var ht=n(et,4),Ta=o(ht);{var Aa=a=>{var r=Ae(),l=o(r,!0);s(r),m(f=>v(l,f),[()=>K(t(e).overloadedUntil)]),u(a,r)},Ea=a=>{var r=Ee();u(a,r)};b(Ta,a=>{t(e).overloadedUntil?a(Aa):a(Ea,!1)})}s(ht);var yt=n(ht,4),bt=o(yt),Da=o(bt,!0);s(bt),s(yt);var xt=n(yt,4),Oa=o(xt);{var Ma=a=>{var r=De(),l=o(r,!0);s(r),m(f=>v(l,f),[()=>K(t(e).opusRateLimitEndAt)]),u(a,r)},Ia=a=>{var r=Oe();u(a,r)};b(Oa,a=>{t(e).opusRateLimitEndAt?a(Ma):a(Ia,!1)})}s(xt);var kt=n(xt,4),Pa=o(kt);{var za=a=>{var r=Ft();m((l,f)=>v(r,`${l??""} (${f??""})`),[()=>Tt(t(e).lastUsedAt),()=>new Date(t(e).lastUsedAt).toLocaleTimeString("en-GB",{hour12:!1})]),u(a,r)},La=a=>{var r=Me();u(a,r)};b(Pa,a=>{t(e).lastUsedAt?a(za):a(La,!1)})}s(kt);var jt=n(kt,4),Na=o(jt);{var Ua=a=>{var r=Ie(),l=o(r,!0);s(r),m(()=>v(l,t(e).errorMessage)),u(a,r)},Ra=a=>{var r=Pe();u(a,r)};b(Na,a=>{t(e).errorMessage?a(Ua):a(Ra,!1)})}s(jt),s(gt);var Ct=n(gt,4);{var ja=a=>{var r=Le();qt(r,21,()=>Object.entries(t(e).stainless),([l,f])=>l,(l,f)=>{var A=J(()=>Ya(t(f),2));let w=()=>t(A)[0],k=()=>t(A)[1];var P=ze(),E=O(P),G=o(E,!0);s(E);var C=n(E,2),St=o(C,!0);s(C),m(()=>{v(G,w()),v(St,k())}),u(l,P)}),s(r),u(a,r)},Ca=J(()=>t(e).stainless&&Object.keys(t(e).stainless).length>0),Ja=a=>{var r=Ne();u(a,r)};b(Ct,a=>{t(Ca)?a(ja):a(Ja,!1)})}var wt=n(Ct,2),Jt=n(o(wt)),Ba=o(Jt);s(Jt),s(wt);var Bt=n(wt,2);{var Ga=a=>{var r=Ue();u(a,r)},Ha=a=>{var r=je(),l=n(o(r));qt(l,21,()=>t(e).sessions,f=>f.session_uuid,(f,A)=>{var w=Re(),k=o(w),P=o(k,!0);s(k);var E=n(k),G=o(E,!0);s(E);var C=n(E),St=o(C,!0);s(C);var Ht=n(C),qa=o(Ht);Kt(qa,{label:"unbind",onclick:()=>X(t(A).session_uuid)}),s(Ht),s(w),m((Ka,Qa)=>{v(P,t(A).session_uuid),v(G,Ka),v(St,Qa)},[()=>Tt(t(A).last_used_at),()=>st(t(A).expires_at)]),u(f,w)}),s(l),s(r),u(a,r)};b(Bt,a=>{t(e).sessions.length===0?a(Ga):a(Ha,!1)})}var Gt=n(Bt,2),Fa=o(Gt);s(Gt),m((a,r,l)=>{v(Q,`${t(e).email??""} `),$(V,1,a),v(it,t(e).status),Y.disabled=t(L),v(aa,t(L)?"[testing...]":"[test]"),$(Z,1,`link ${t(e).status==="disabled"?"g":"r"}`),v(ea,`[${t(e).status==="disabled"?"enable":"disable"}]`),v(na,t(e).id),v(pa,r),$(et,1,rt(t(e).schedulable?"g":"r")),v(Sa,t(e).schedulable?"yes":"no"),$(bt,1,l),v(Da,t(e).fiveHourStatus||"-"),v(Ba,`(${t(e).sessions.length??""})`),At(Fa,"href",`${Et??""}/dashboard`)},[()=>rt(Za(t(e).status)),()=>$a(t(e).createdAt),()=>rt(ot(t(e).fiveHourStatus))]),M("click",Y,p),M("click",Pt,T),M("click",Z,D),u(i,_)};b(Yt,i=>{t(j)?i(Zt):t(F)?i($t,1):t(e)&&i(ta,2)})}u(W,It),Ot(),I()}Vt(["click","keydown"]);export{tr as component,$e as universal};
