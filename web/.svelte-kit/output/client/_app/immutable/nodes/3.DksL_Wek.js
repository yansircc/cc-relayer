import{a as u,f as c,c as Va,t as Ft}from"../chunks/DSgr-hxR.js";import{a as Dt,s as S,o as Wa,k as d,ac as Xa,e as o,i as s,j as m,g as t,b as Ot,ab as G,aa as Qt,f as O,d as n,ar as Ya}from"../chunks/lUnH5NgY.js";import{s as v,d as Vt,a as M}from"../chunks/CMUPHsw8.js";import{i as y}from"../chunks/ChPJZGYw.js";import{s as $,c as st,t as Za,f as $a,a as Tt,e as qt}from"../chunks/CjJWkJbP.js";import{r as Wt,s as At}from"../chunks/DUKUYMvf.js";import{b as Xt}from"../chunks/CId_XQ1p.js";import{s as te,a as ae}from"../chunks/BMgpKV-T.js";import{p as ee}from"../chunks/CbltZmeM.js";import{g as re}from"../chunks/BZPCr9dl.js";import{b as Et}from"../chunks/NZDo04p-.js";import{a as L}from"../chunks/DtH33QRI.js";import{C as Kt}from"../chunks/nuLSc5cV.js";const se=!1,$e=Object.freeze(Object.defineProperty({__proto__:null,ssr:se},Symbol.toStringTag,{value:"Module"}));var oe=c("<span> </span>");function ne(W,h){Dt(h,!0);let q=S(Wa(Date.now()));const C=setInterval(()=>{d(q,Date.now(),!0)},1e3);Xa(()=>clearInterval(C));let I=G(()=>h.expiresAt-t(q)),e=G(()=>t(I)<=0),J=G(()=>{if(t(e))return"expired";const g=Math.floor(t(I)/1e3),Q=Math.floor(g/60),V=g%60;return`${Q}m ${String(V).padStart(2,"0")}s remaining`}),K=G(()=>{if(t(e))return"r";const g=Math.floor(t(I)/6e4);return g<10?"r":g<60?"o":"g"});var b=oe(),N=o(b,!0);s(b),m(()=>{$(b,1,st(t(K))),v(N,t(J))}),u(W,b),Ot()}var ie=c('<span class="g">auto</span> <span class="muted"> </span> <button class="link" style="font-size:12px;margin-left:6px">[switch to manual]</button>',1),de=c('<input class="pri-edit svelte-1uolqt3" type="text"/> <button class="link" style="font-size:12px"> </button> <button class="link" style="font-size:12px;margin-left:6px">[switch to auto]</button>',1),le=c('<span class="error-msg"> </span>'),ue=c("<!> <!>",1);function ve(W,h){Dt(h,!0);let q=G(()=>h.priorityMode==="auto"),C=S(""),I=S(!1),e=S("");Qt(()=>{d(C,String(h.priority),!0)});async function J(){const p=parseInt(t(C));if(!isNaN(p)){d(I,!0),d(e,"");try{await L(`/accounts/${h.accountId}/priority`,{method:"POST",body:JSON.stringify({mode:"manual",priority:p})}),h.onupdate("manual",p)}catch(T){d(e,T.message,!0)}finally{d(I,!1)}}}async function K(){d(e,"");try{await L(`/accounts/${h.accountId}/priority`,{method:"POST",body:JSON.stringify({mode:"auto"})}),h.onupdate("auto",h.priority)}catch(p){d(e,p.message,!0)}}async function b(){d(e,"");try{await L(`/accounts/${h.accountId}/priority`,{method:"POST",body:JSON.stringify({mode:"manual",priority:h.priority})}),h.onupdate("manual",h.priority)}catch(p){d(e,p.message,!0)}}var N=ue(),g=O(N);{var Q=p=>{var T=ie(),D=n(O(T),2),U=o(D);s(D);var X=n(D,2);m(()=>v(U,`(score: ${h.autoScore??""})`)),M("click",X,b),u(p,T)},V=p=>{var T=de(),D=O(T);Wt(D);var U=n(D,2),X=o(U,!0);s(U);var it=n(U,2);m(()=>{U.disabled=t(I),v(X,t(I)?"saving...":"[save]")}),M("keydown",D,R=>{R.key==="Enter"&&J()}),Xt(D,()=>t(C),R=>d(C,R)),M("click",U,J),M("click",it,K),u(p,T)};y(g,p=>{t(q)?p(Q):p(V,!1)})}var ot=n(g,2);{var nt=p=>{var T=le(),D=o(T,!0);s(T),m(()=>v(D,t(e))),u(p,T)};y(ot,p=>{t(e)&&p(nt)})}u(W,N),Ot()}Vt(["click","keydown"]);var ce=c('<p class="error-msg"> </p> <p><a>&larr; back to dashboard</a></p>',1),fe=c('<p class="loading">loading account...</p>'),_e=c('<p class="error-msg"> </p>'),pe=c('<span class="g">&#10003; ok</span> <span class="muted"> </span>',1),me=c('<span class="r">&#10007; failed</span> <span class="muted"> </span>',1),ge=c('<div class="bar" style="margin-top:0"><!></div>'),he=c('<input type="text" style="width:240px;font:13px monospace;border:1px solid #ccc;padding:0 4px;"/> <button class="link" style="font-size:12px"> </button> <button class="link" style="font-size:12px;margin-left:4px">[cancel]</button>',1),ye=c(' <button class="link" style="font-size:12px;margin-left:6px">[edit]</button>',1),be=c('<span class="error-msg"> </span>'),xe=c(' <span class="muted"> </span>',1),ke=c('<span class="muted">-</span>'),we=c('<span class="muted">-</span>'),Se=c('<span class="g">ok</span>'),Te=c('<span class="r">expired</span>'),Ae=c('<span class="o"> </span>'),Ee=c('<span class="muted">-</span>'),De=c('<span class="o"> </span>'),Oe=c('<span class="muted">-</span>'),Me=c('<span class="muted">-</span>'),Ie=c('<span class="r"> </span>'),Pe=c('<span class="muted">-</span>'),ze=c("<dt> </dt> <dd> </dd>",1),Le=c("<dl></dl>"),Ne=c('<p class="muted">not captured yet</p>'),Ue=c('<p class="muted">no active session bindings</p>'),Re=c('<tr><td class="muted"> </td><td> </td><td> </td><td><!></td></tr>'),je=c("<table><thead><tr><th>session uuid</th><th>last active</th><th>ttl</th><th></th></tr></thead><tbody></tbody></table>"),Ce=c('<h2> <span> </span></h2> <div class="actions"><button class="link"> </button> <button class="link">[force refresh token]</button> <button> </button> <!></div> <!> <!> <h2>info</h2> <dl><dt>id</dt> <dd class="muted"> </dd> <dt>email</dt> <dd><!> <!></dd> <dt>org</dt> <dd><!></dd> <dt>priority</dt> <dd><!></dd> <dt>created</dt> <dd> </dd></dl> <h2>token</h2> <dl><dt>access token expires</dt> <dd><!></dd> <dt>last refreshed</dt> <dd><!></dd> <dt>refresh status</dt> <dd><!></dd></dl> <h2>scheduling</h2> <dl><dt>schedulable</dt> <dd> </dd> <dt>overloaded until</dt> <dd><!></dd> <dt>5h window</dt> <dd><span> </span></dd> <dt>opus rate limit</dt> <dd><!></dd> <dt>last used</dt> <dd><!></dd> <dt>error message</dt> <dd><!></dd></dl> <h2>stainless fingerprint</h2> <!> <h2>bound sessions <span class="muted"> </span></h2> <!> <p style="margin-top:16px;font-size:12px"><a>&larr; back</a></p>',1);function tr(W,h){Dt(h,!0);const q=()=>te(ee,"$page",C),[C,I]=ae();let e=S(null),J=S(""),K=S(!0),b=S(null),N=S(!1),g=S("");Qt(()=>{Q()});async function Q(){try{d(e,await L("/accounts/"+q().params.id),!0)}catch(i){d(J,i.message,!0)}finally{d(K,!1)}}function V(i){if(!i)return"-";const _=new Date(i).getTime()-Date.now();if(_<=0)return"passed";const k=Math.floor(_/1e3),P=Math.floor(k/60),j=k%60;return P<60?`${P}m ${String(j).padStart(2,"0")}s`:`${Math.floor(P/60)}h ${P%60}m ${String(j).padStart(2,"0")}s`}function ot(i){if(!i)return"-";const _=new Date(i).getTime()-Date.now();if(_<=0)return"expired";const k=Math.floor(_/6e4);return k<60?`${k}m`:`${Math.floor(k/60)}h ${k%60}m`}function nt(i){return i==="allowed"?"g":i==="stopped"||i==="warning"?"o":"r"}async function p(){if(t(e)){d(N,!0),d(b,null);try{const i=await L(`/accounts/${t(e).id}/test`,{method:"POST"});d(b,{...i,time:new Date().toLocaleTimeString("en-GB",{hour12:!1})},!0)}catch(i){d(b,{ok:!1,latency_ms:0,error:i.message,time:new Date().toLocaleTimeString("en-GB",{hour12:!1})},!0)}finally{d(N,!1)}}}async function T(){if(t(e)){d(g,"");try{await L(`/accounts/${t(e).id}/refresh`,{method:"POST"}),await Q()}catch(i){d(g,i.message,!0)}}}async function D(){if(!t(e))return;const i=t(e).status==="disabled"?"active":"disabled";d(g,"");try{await L(`/accounts/${t(e).id}/status`,{method:"POST",body:JSON.stringify({status:i})}),t(e).status=i}catch(_){d(g,_.message,!0)}}async function U(){if(t(e)){d(g,"");try{await L(`/accounts/${t(e).id}`,{method:"DELETE"}),re(`${Et}/dashboard`)}catch(i){d(g,i.message,!0)}}}async function X(i){if(t(e)){d(g,"");try{await L(`/sessions/binding/${i}`,{method:"DELETE"}),t(e).sessions=t(e).sessions.filter(_=>_.session_uuid!==i)}catch(_){d(g,_.message,!0)}}}function it(i,_){t(e)&&(t(e).priority_mode=i,t(e).priority=_)}let R=S(!1),tt=S(""),at=S(!1),H=S("");async function Mt(){if(!t(e))return;const i=t(tt).trim();if(i){d(at,!0),d(H,"");try{const _=await L(`/accounts/${t(e).id}/email`,{method:"POST",body:JSON.stringify({email:i})});t(e).email=_.email,d(R,!1)}catch(_){d(H,_.message,!0)}finally{d(at,!1)}}}var It=Va(),Yt=O(It);{var Zt=i=>{var _=ce(),k=O(_),P=o(k,!0);s(k);var j=n(k,2),et=o(j);s(j),m(()=>{v(P,t(J)),At(et,"href",`${Et??""}/dashboard`)}),u(i,_)},$t=i=>{var _=fe();u(i,_)},ta=i=>{var _=Ce(),k=O(_),P=o(k),j=n(P),et=o(j,!0);s(j),s(k);var dt=n(k,2),Y=o(dt),aa=o(Y,!0);s(Y);var Pt=n(Y,2),Z=n(Pt,2),ea=o(Z);s(Z);var ra=n(Z,2);Kt(ra,{label:"[delete]",cls:"r",onclick:U}),s(dt);var zt=n(dt,2);{var sa=a=>{var r=_e(),l=o(r,!0);s(r),m(()=>v(l,t(g))),u(a,r)};y(zt,a=>{t(g)&&a(sa)})}var Lt=n(zt,2);{var oa=a=>{var r=ge(),l=o(r);{var f=w=>{var x=pe(),z=n(O(x)),E=n(z),F=o(E,!0);s(E),m(B=>{v(z,` — haiku — ${B??""}s — `),v(F,t(b).time)},[()=>(t(b).latency_ms/1e3).toFixed(1)]),u(w,x)},A=w=>{var x=me(),z=n(O(x)),E=n(z),F=o(E,!0);s(E),m(()=>{v(z,` — ${t(b).error??""} — `),v(F,t(b).time)}),u(w,x)};y(l,w=>{t(b).ok?w(f):w(A,!1)})}s(r),u(a,r)};y(Lt,a=>{t(b)&&a(oa)})}var lt=n(Lt,4),ut=n(o(lt),2),na=o(ut,!0);s(ut);var vt=n(ut,4),Nt=o(vt);{var ia=a=>{var r=he(),l=O(r);Wt(l),At(l,"maxlength",100);var f=n(l,2),A=o(f,!0);s(f);var w=n(f,2);m(()=>{f.disabled=t(at),v(A,t(at)?"saving...":"[save]")}),M("keydown",l,x=>{x.key==="Enter"&&Mt(),x.key==="Escape"&&(d(R,!1),d(H,""))}),Xt(l,()=>t(tt),x=>d(tt,x)),M("click",f,Mt),M("click",w,()=>{d(R,!1),d(H,"")}),u(a,r)},da=a=>{var r=ye(),l=O(r),f=n(l);m(()=>v(l,`${t(e).email??""} `)),M("click",f,()=>{d(tt,t(e).email,!0),d(R,!0),d(H,"")}),u(a,r)};y(Nt,a=>{t(R)?a(ia):a(da,!1)})}var la=n(Nt,2);{var ua=a=>{var r=be(),l=o(r,!0);s(r),m(()=>v(l,t(H))),u(a,r)};y(la,a=>{t(H)&&a(ua)})}s(vt);var ct=n(vt,4),va=o(ct);{var ca=a=>{var r=xe(),l=O(r),f=n(l),A=o(f);s(f),m(()=>{v(l,`${t(e).extInfo.orgName??""} `),v(A,`(uuid: ${t(e).extInfo.orgUUID??""})`)}),u(a,r)},fa=a=>{var r=ke();u(a,r)};y(va,a=>{t(e).extInfo?a(ca):a(fa,!1)})}s(ct);var ft=n(ct,4),_a=o(ft);ve(_a,{get accountId(){return t(e).id},get priority(){return t(e).priority},get priorityMode(){return t(e).priority_mode},get autoScore(){return t(e).auto_score},onupdate:it}),s(ft);var Ut=n(ft,4),pa=o(Ut,!0);s(Ut),s(lt);var _t=n(lt,4),pt=n(o(_t),2),ma=o(pt);ne(ma,{get expiresAt(){return t(e).expiresAt}}),s(pt);var mt=n(pt,4),ga=o(mt);{var ha=a=>{var r=Ft();m((l,f)=>v(r,`${l??""} (${f??""})`),[()=>Tt(t(e).lastRefreshAt),()=>new Date(t(e).lastRefreshAt).toLocaleTimeString("en-GB",{hour12:!1})]),u(a,r)},ya=a=>{var r=we();u(a,r)};y(ga,a=>{t(e).lastRefreshAt?a(ha):a(ya,!1)})}s(mt);var Rt=n(mt,4),ba=o(Rt);{var xa=a=>{var r=Se();u(a,r)},ka=G(()=>t(e).expiresAt>Date.now()),wa=a=>{var r=Te();u(a,r)};y(ba,a=>{t(ka)?a(xa):a(wa,!1)})}s(Rt),s(_t);var gt=n(_t,4),rt=n(o(gt),2),Sa=o(rt,!0);s(rt);var ht=n(rt,4),Ta=o(ht);{var Aa=a=>{var r=Ae(),l=o(r,!0);s(r),m(f=>v(l,f),[()=>V(t(e).overloadedUntil)]),u(a,r)},Ea=a=>{var r=Ee();u(a,r)};y(Ta,a=>{t(e).overloadedUntil?a(Aa):a(Ea,!1)})}s(ht);var yt=n(ht,4),bt=o(yt),Da=o(bt,!0);s(bt),s(yt);var xt=n(yt,4),Oa=o(xt);{var Ma=a=>{var r=De(),l=o(r,!0);s(r),m(f=>v(l,f),[()=>V(t(e).opusRateLimitEndAt)]),u(a,r)},Ia=a=>{var r=Oe();u(a,r)};y(Oa,a=>{t(e).opusRateLimitEndAt?a(Ma):a(Ia,!1)})}s(xt);var kt=n(xt,4),Pa=o(kt);{var za=a=>{var r=Ft();m((l,f)=>v(r,`${l??""} (${f??""})`),[()=>Tt(t(e).lastUsedAt),()=>new Date(t(e).lastUsedAt).toLocaleTimeString("en-GB",{hour12:!1})]),u(a,r)},La=a=>{var r=Me();u(a,r)};y(Pa,a=>{t(e).lastUsedAt?a(za):a(La,!1)})}s(kt);var jt=n(kt,4),Na=o(jt);{var Ua=a=>{var r=Ie(),l=o(r,!0);s(r),m(()=>v(l,t(e).errorMessage)),u(a,r)},Ra=a=>{var r=Pe();u(a,r)};y(Na,a=>{t(e).errorMessage?a(Ua):a(Ra,!1)})}s(jt),s(gt);var Ct=n(gt,4);{var ja=a=>{var r=Le();qt(r,21,()=>Object.entries(t(e).stainless),([l,f])=>l,(l,f)=>{var A=G(()=>Ya(t(f),2));let w=()=>t(A)[0],x=()=>t(A)[1];var z=ze(),E=O(z),F=o(E,!0);s(E);var B=n(E,2),St=o(B,!0);s(B),m(()=>{v(F,w()),v(St,x())}),u(l,z)}),s(r),u(a,r)},Ca=G(()=>t(e).stainless&&Object.keys(t(e).stainless).length>0),Ja=a=>{var r=Ne();u(a,r)};y(Ct,a=>{t(Ca)?a(ja):a(Ja,!1)})}var wt=n(Ct,2),Jt=n(o(wt)),Ba=o(Jt);s(Jt),s(wt);var Bt=n(wt,2);{var Ga=a=>{var r=Ue();u(a,r)},Ha=a=>{var r=je(),l=n(o(r));qt(l,21,()=>t(e).sessions,f=>f.session_uuid,(f,A)=>{var w=Re(),x=o(w),z=o(x,!0);s(x);var E=n(x),F=o(E,!0);s(E);var B=n(E),St=o(B,!0);s(B);var Ht=n(B),qa=o(Ht);Kt(qa,{label:"unbind",onclick:()=>X(t(A).session_uuid)}),s(Ht),s(w),m((Ka,Qa)=>{v(z,t(A).session_uuid),v(F,Ka),v(St,Qa)},[()=>Tt(t(A).last_used_at),()=>ot(t(A).expires_at)]),u(f,w)}),s(l),s(r),u(a,r)};y(Bt,a=>{t(e).sessions.length===0?a(Ga):a(Ha,!1)})}var Gt=n(Bt,2),Fa=o(Gt);s(Gt),m((a,r,l)=>{v(P,`${t(e).email??""} `),$(j,1,a),v(et,t(e).status),Y.disabled=t(N),v(aa,t(N)?"[testing...]":"[test]"),$(Z,1,`link ${t(e).status==="disabled"?"g":"r"}`),v(ea,`[${t(e).status==="disabled"?"enable":"disable"}]`),v(na,t(e).id),v(pa,r),$(rt,1,st(t(e).schedulable?"g":"r")),v(Sa,t(e).schedulable?"yes":"no"),$(bt,1,l),v(Da,t(e).fiveHourStatus||"-"),v(Ba,`(${t(e).sessions.length??""})`),At(Fa,"href",`${Et??""}/dashboard`)},[()=>st(Za(t(e).status)),()=>$a(t(e).createdAt),()=>st(nt(t(e).fiveHourStatus))]),M("click",Y,p),M("click",Pt,T),M("click",Z,D),u(i,_)};y(Yt,i=>{t(J)?i(Zt):t(K)?i($t,1):t(e)&&i(ta,2)})}u(W,It),Ot(),I()}Vt(["click","keydown"]);export{tr as component,$e as universal};
